/*
 Platform.js <https://mths.be/platform>
 Copyright 2014-2018 Benjamin Tan <https://bnjmnt4n.now.sh/>
 Copyright 2011-2013 John-David Dalton
 Available under MIT license <https://mths.be/mit>
*/
(function(){var a="undefined"!==typeof window&&"undefined"!==typeof window.document?window.document:{},e="undefined"!==typeof module&&module.exports,c="undefined"!==typeof Element&&"ALLOW_KEYBOARD_INPUT"in Element,f=function(){for(var c,b=["requestFullscreen exitFullscreen fullscreenElement fullscreenEnabled fullscreenchange fullscreenerror".split(" "),"webkitRequestFullscreen webkitExitFullscreen webkitFullscreenElement webkitFullscreenEnabled webkitfullscreenchange webkitfullscreenerror".split(" "),
"webkitRequestFullScreen webkitCancelFullScreen webkitCurrentFullScreenElement webkitCancelFullScreen webkitfullscreenchange webkitfullscreenerror".split(" "),"mozRequestFullScreen mozCancelFullScreen mozFullScreenElement mozFullScreenEnabled mozfullscreenchange mozfullscreenerror".split(" "),"msRequestFullscreen msExitFullscreen msFullscreenElement msFullscreenEnabled MSFullscreenChange MSFullscreenError".split(" ")],d=0,n=b.length,e={};d<n;d++)if((c=b[d])&&c[1]in a){for(d=0;d<c.length;d++)e[b[0][d]]=
c[d];return e}return!1}(),h={change:f.fullscreenchange,error:f.fullscreenerror},l={request:function(e){var b=f.requestFullscreen;e=e||a.documentElement;if(/5\.1[.\d]* Safari/.test(navigator.userAgent))e[b]();else e[b](c&&Element.ALLOW_KEYBOARD_INPUT)},exit:function(){a[f.exitFullscreen]()},toggle:function(a){this.isFullscreen?this.exit():this.request(a)},onchange:function(a){this.on("change",a)},onerror:function(a){this.on("error",a)},on:function(c,b){var d=h[c];d&&a.addEventListener(d,b,!1)},off:function(c,
b){var d=h[c];d&&a.removeEventListener(d,b,!1)},raw:f};f?(Object.defineProperties(l,{isFullscreen:{get:function(){return!!a[f.fullscreenElement]}},element:{enumerable:!0,get:function(){return a[f.fullscreenElement]}},enabled:{enumerable:!0,get:function(){return!!a[f.fullscreenEnabled]}}}),e?module.exports=l:window.screenfull=l):e?module.exports=!1:window.screenfull=!1})();
(function(){function a(a){a=String(a);return a.charAt(0).toUpperCase()+a.slice(1)}function e(a,b){var d=-1,c=a?a.length:0;if("number"==typeof c&&-1<c&&c<=w)for(;++d<c;)b(a[d],d,a);else f(a,b)}function c(b){b=String(b).replace(/^ +| +$/g,"");return/^(?:webOS|i(?:OS|P))/.test(b)?b:a(b)}function f(a,b){for(var d in a)u.call(a,d)&&b(a[d],d,a)}function h(b){return null==b?a(b):t.call(b).slice(8,-1)}function l(a,b){var d=null!=a?typeof a[b]:"number";return!/^(?:boolean|number|string|undefined)$/.test(d)&&
("object"==d?!!a[b]:!0)}function k(a){return String(a).replace(/([ -])(?!$)/g,"$1?")}function b(a,b){var d=null;e(a,function(c,e){d=b(d,c,e,a)});return d}function d(a){function e(d){return b(d,function(b,d){var e=d.pattern||k(d);!b&&(b=RegExp("\\b"+e+" *\\d+[.\\w_]*","i").exec(a)||RegExp("\\b"+e+" *\\w+-[\\w]*","i").exec(a)||RegExp("\\b"+e+"(?:; *(?:[a-z]+[_-])?[a-z]+\\d+|[^ ();-]*)","i").exec(a))&&((b=String(d.label&&!RegExp(e,"i").test(d.label)?d.label:b).split("/"))[1]&&!/[\d.]+/.test(b[0])&&(b[0]+=
" "+b[1]),d=d.label||d,b=c(b[0].replace(RegExp(e,"i"),d).replace(RegExp("; *(?:"+d+"[_-])?","i")," ").replace(RegExp("("+d+")[-_.]?(\\w)","i"),"$1 $2")));return b})}function n(d){return b(d,function(b,d){return b||(RegExp(d+"(?:-[\\d.]+/|(?: for [\\w-]+)?[ /-])([\\d.]+[^ ();/_-]*)","i").exec(a)||0)[1]||null})}var g=r,q=a&&"object"==typeof a&&"String"!=h(a);q&&(g=a,a=null);var w=g.navigator||{},p=w.userAgent||"";a||(a=p);var y=q?!!w.likeChrome:/\bChrome\b/.test(a)&&!/internal|\n/i.test(t.toString()),
u=q?"Object":"ScriptBridgingProxyObject",G=q?"Object":"Environment",I=q&&g.java?"JavaPackage":h(g.java),D=q?"Object":"RuntimeObject";G=(I=/\bJava/.test(I)&&g.java)&&h(g.environment)==G;var O=I?"a":"\u03b1",N=I?"b":"\u03b2",K=g.document||{},C=g.operamini||g.opera,T=v.test(T=q&&C?C["[[Class]]"]:h(C))?T:C=null,m,U=a;q=[];var V=null,S=a==p;p=S&&C&&"function"==typeof C.version&&C.version();var E=function(d){return b(d,function(b,d){return b||RegExp("\\b"+(d.pattern||k(d))+"\\b","i").exec(a)&&(d.label||
d)})}([{label:"EdgeHTML",pattern:"Edge"},"Trident",{label:"WebKit",pattern:"AppleWebKit"},"iCab","Presto","NetFront","Tasman","KHTML","Gecko"]),x=function(d){return b(d,function(b,d){return b||RegExp("\\b"+(d.pattern||k(d))+"\\b","i").exec(a)&&(d.label||d)})}(["Adobe AIR","Arora","Avant Browser","Breach","Camino","Electron","Epiphany","Fennec","Flock","Galeon","GreenBrowser","iCab","Iceweasel","K-Meleon","Konqueror","Lunascape","Maxthon",{label:"Microsoft Edge",pattern:"Edge"},"Midori","Nook Browser",
"PaleMoon","PhantomJS","Raven","Rekonq","RockMelt",{label:"Samsung Internet",pattern:"SamsungBrowser"},"SeaMonkey",{label:"Silk",pattern:"(?:Cloud9|Silk-Accelerated)"},"Sleipnir","SlimBrowser",{label:"SRWare Iron",pattern:"Iron"},"Sunrise","Swiftfox","Waterfox","WebPositive","Opera Mini",{label:"Opera Mini",pattern:"OPiOS"},"Opera",{label:"Opera",pattern:"OPR"},"Chrome",{label:"Chrome Mobile",pattern:"(?:CriOS|CrMo)"},{label:"Firefox",pattern:"(?:Firefox|Minefield)"},{label:"Firefox for iOS",pattern:"FxiOS"},
{label:"IE",pattern:"IEMobile"},{label:"IE",pattern:"MSIE"},"Safari"]),F=e([{label:"BlackBerry",pattern:"BB10"},"BlackBerry",{label:"Galaxy S",pattern:"GT-I9000"},{label:"Galaxy S2",pattern:"GT-I9100"},{label:"Galaxy S3",pattern:"GT-I9300"},{label:"Galaxy S4",pattern:"GT-I9500"},{label:"Galaxy S5",pattern:"SM-G900"},{label:"Galaxy S6",pattern:"SM-G920"},{label:"Galaxy S6 Edge",pattern:"SM-G925"},{label:"Galaxy S7",pattern:"SM-G930"},{label:"Galaxy S7 Edge",pattern:"SM-G935"},"Google TV","Lumia","iPad",
"iPod","iPhone","Kindle",{label:"Kindle Fire",pattern:"(?:Cloud9|Silk-Accelerated)"},"Nexus","Nook","PlayBook","PlayStation Vita","PlayStation","TouchPad","Transformer",{label:"Wii U",pattern:"WiiU"},"Wii","Xbox One",{label:"Xbox 360",pattern:"Xbox"},"Xoom"]),P=function(d){return b(d,function(b,d,c){return b||(d[F]||d[/^[a-z]+(?: +[a-z]+\b)*/i.exec(F)]||RegExp("\\b"+k(c)+"(?:\\b|\\w*\\d)","i").exec(a))&&c})}({Apple:{iPad:1,iPhone:1,iPod:1},Archos:{},Amazon:{Kindle:1,"Kindle Fire":1},Asus:{Transformer:1},
"Barnes & Noble":{Nook:1},BlackBerry:{PlayBook:1},Google:{"Google TV":1,Nexus:1},HP:{TouchPad:1},HTC:{},LG:{},Microsoft:{Xbox:1,"Xbox One":1},Motorola:{Xoom:1},Nintendo:{"Wii U":1,Wii:1},Nokia:{Lumia:1},Samsung:{"Galaxy S":1,"Galaxy S2":1,"Galaxy S3":1,"Galaxy S4":1},Sony:{PlayStation:1,"PlayStation Vita":1}}),z=function(d){return b(d,function(b,d){var e=d.pattern||k(d);if(!b&&(b=RegExp("\\b"+e+"(?:/[\\d.]+|[ \\w.]*)","i").exec(a))){var g=b,n=d.label||d,q={"10.0":"10","6.4":"10 Technical Preview",
"6.3":"8.1","6.2":"8","6.1":"Server 2008 R2 / 7","6.0":"Server 2008 / Vista","5.2":"Server 2003 / XP 64-bit","5.1":"XP","5.01":"2000 SP1","5.0":"2000","4.0":"NT","4.90":"ME"};e&&n&&/^Win/i.test(g)&&!/^Windows Phone /i.test(g)&&(q=q[/[\d.]+$/.exec(g)])&&(g="Windows "+q);g=String(g);e&&n&&(g=g.replace(RegExp(e,"i"),n));b=g=c(g.replace(/ ce$/i," CE").replace(/\bhpw/i,"web").replace(/\bMacintosh\b/,"Mac OS").replace(/_PowerPC\b/i," OS").replace(/\b(OS X) [^ \d]+/i,"$1").replace(/\bMac (OS X)\b/,"$1").replace(/\/(\d)/,
" $1").replace(/_/g,".").replace(/(?: BePC|[ .]*fc[ \d.]+)$/i,"").replace(/\bx86\.64\b/gi,"x86_64").replace(/\b(Windows Phone) OS\b/,"$1").replace(/\b(Chrome OS \w+) [\d.]+\b/,"$1").split(" on ")[0])}return b})}(["Windows Phone","Android","CentOS",{label:"Chrome OS",pattern:"CrOS"},"Debian","Fedora","FreeBSD","Gentoo","Haiku","Kubuntu","Linux Mint","OpenBSD","Red Hat","SuSE","Ubuntu","Xubuntu","Cygwin","Symbian OS","hpwOS","webOS ","webOS","Tablet OS","Tizen","Linux","Mac OS X","Macintosh","Mac",
"Windows 98;","Windows "]);E&&(E=[E]);P&&!F&&(F=e([P]));if(m=/\bGoogle TV\b/.exec(F))F=m[0];/\bSimulator\b/i.test(a)&&(F=(F?F+" ":"")+"Simulator");"Opera Mini"==x&&/\bOPiOS\b/.test(a)&&q.push("running in Turbo/Uncompressed mode");"IE"==x&&/\blike iPhone OS\b/.test(a)?(m=d(a.replace(/like iPhone OS/,"")),P=m.manufacturer,F=m.product):/^iP/.test(F)?(x||(x="Safari"),z="iOS"+((m=/ OS ([\d_]+)/i.exec(a))?" "+m[1].replace(/_/g,"."):"")):"Konqueror"!=x||/buntu/i.test(z)?P&&"Google"!=P&&(/Chrome/.test(x)&&
!/\bMobile Safari\b/i.test(a)||/\bVita\b/.test(F))||/\bAndroid\b/.test(z)&&/^Chrome/.test(x)&&/\bVersion\//i.test(a)?(x="Android Browser",z=/\bAndroid\b/.test(z)?z:"Android"):"Silk"==x?(/\bMobi/i.test(a)||(z="Android",q.unshift("desktop mode")),/Accelerated *= *true/i.test(a)&&q.unshift("accelerated")):"PaleMoon"==x&&(m=/\bFirefox\/([\d.]+)\b/.exec(a))?q.push("identifying as Firefox "+m[1]):"Firefox"==x&&(m=/\b(Mobile|Tablet|TV)\b/i.exec(a))?(z||(z="Firefox OS"),F||(F=m[1])):!x||(m=!/\bMinefield\b/i.test(a)&&
/\b(?:Firefox|Safari)\b/.exec(x))?(x&&!F&&/[\/,]|^[^(]+?\)/.test(a.slice(a.indexOf(m+"/")+8))&&(x=null),(m=F||P||z)&&(F||P||/\b(?:Android|Symbian OS|Tablet OS|webOS)\b/.test(z))&&(x=/[a-z]+(?: Hat)?/i.exec(/\bAndroid\b/.test(z)?z:m)+" Browser")):"Electron"==x&&(m=(/\bChrome\/([\d.]+)\b/.exec(a)||0)[1])&&q.push("Chromium "+m):z="Kubuntu";p||(p=n(["(?:Cloud9|CriOS|CrMo|Edge|FxiOS|IEMobile|Iron|Opera ?Mini|OPiOS|OPR|Raven|SamsungBrowser|Silk(?!/[\\d.]+$))","Version",k(x),"(?:Firefox|Minefield|NetFront)"]));
if(m="iCab"==E&&3<parseFloat(p)&&"WebKit"||/\bOpera\b/.test(x)&&(/\bOPR\b/.test(a)?"Blink":"Presto")||/\b(?:Midori|Nook|Safari)\b/i.test(a)&&!/^(?:Trident|EdgeHTML)$/.test(E)&&"WebKit"||!E&&/\bMSIE\b/i.test(a)&&("Mac OS"==z?"Tasman":"Trident")||"WebKit"==E&&/\bPlayStation\b(?! Vita\b)/i.test(x)&&"NetFront")E=[m];"IE"==x&&(m=(/; *(?:XBLWP|ZuneWP)(\d+)/i.exec(a)||0)[1])?(x+=" Mobile",z="Windows Phone "+(/\+$/.test(m)?m:m+".x"),q.unshift("desktop mode")):/\bWPDesktop\b/i.test(a)?(x="IE Mobile",z="Windows Phone 8.x",
q.unshift("desktop mode"),p||(p=(/\brv:([\d.]+)/.exec(a)||0)[1])):"IE"!=x&&"Trident"==E&&(m=/\brv:([\d.]+)/.exec(a))&&(x&&q.push("identifying as "+x+(p?" "+p:"")),x="IE",p=m[1]);if(S){if(l(g,"global"))if(I&&(m=I.lang.System,U=m.getProperty("os.arch"),z=z||m.getProperty("os.name")+" "+m.getProperty("os.version")),G){try{p=g.require("ringo/engine").version.join("."),x="RingoJS"}catch(X){(m=g.system)&&m.global.system==g.system&&(x="Narwhal",z||(z=m[0].os||null))}x||(x="Rhino")}else"object"==typeof g.process&&
!g.process.browser&&(m=g.process)&&("object"==typeof m.versions&&("string"==typeof m.versions.electron?(q.push("Node "+m.versions.node),x="Electron",p=m.versions.electron):"string"==typeof m.versions.nw&&(q.push("Chromium "+p,"Node "+m.versions.node),x="NW.js",p=m.versions.nw)),x||(x="Node.js",U=m.arch,z=m.platform,p=(p=/[\d.]+/.exec(m.version))?p[0]:null));else h(m=g.runtime)==u?(x="Adobe AIR",z=m.flash.system.Capabilities.os):h(m=g.phantom)==D?(x="PhantomJS",p=(m=m.version||null)&&m.major+"."+m.minor+
"."+m.patch):"number"==typeof K.documentMode&&(m=/\bTrident\/(\d+)/i.exec(a))?(p=[p,K.documentMode],(m=+m[1]+4)!=p[1]&&(q.push("IE "+p[1]+" mode"),E&&(E[1]=""),p[1]=m),p="IE"==x?String(p[1].toFixed(1)):p[0]):"number"==typeof K.documentMode&&/^(?:Chrome|Firefox)\b/.test(x)&&(q.push("masking as "+x+" "+p),x="IE",p="11.0",E=["Trident"],z="Windows");z=z&&c(z)}p&&(m=/(?:[ab]|dp|pre|[ab]\d+pre)(?:\d+\+?)?$/i.exec(p)||/(?:alpha|beta)(?: ?\d)?/i.exec(a+";"+(S&&w.appMinorVersion))||/\bMinefield\b/i.test(a)&&
"a")&&(V=/b/i.test(m)?"beta":"alpha",p=p.replace(RegExp(m+"\\+?$"),"")+("beta"==V?N:O)+(/\d+\+?/.exec(m)||""));if("Fennec"==x||"Firefox"==x&&/\b(?:Android|Firefox OS)\b/.test(z))x="Firefox Mobile";else if("Maxthon"==x&&p)p=p.replace(/\.[\d.]+/,".x");else if(/\bXbox\b/i.test(F))"Xbox 360"==F&&(z=null),"Xbox 360"==F&&/\bIEMobile\b/.test(a)&&q.unshift("mobile mode");else if(!/^(?:Chrome|IE|Opera)$/.test(x)&&(!x||F||/Browser|Mobi/.test(x))||"Windows CE"!=z&&!/Mobi/i.test(a))if("IE"==x&&S)try{null===g.external&&
q.unshift("platform preview")}catch(X){q.unshift("embedded")}else(/\bBlackBerry\b/.test(F)||/\bBB10\b/.test(a))&&(m=(RegExp(F.replace(/ +/g," *")+"/([.\\d]+)","i").exec(a)||0)[1]||p)?(m=[m,/BB10/.test(a)],z=(m[1]?(F=null,P="BlackBerry"):"Device Software")+" "+m[0],p=null):this!=f&&"Wii"!=F&&(S&&C||/Opera/.test(x)&&/\b(?:MSIE|Firefox)\b/i.test(a)||"Firefox"==x&&/\bOS X (?:\d+\.){2,}/.test(z)||"IE"==x&&(z&&!/^Win/.test(z)&&5.5<p||/\bWindows XP\b/.test(z)&&8<p||8==p&&!/\bTrident\b/.test(a)))&&!v.test(m=
d.call(f,a.replace(v,"")+";"))&&m.name&&(m="ing as "+m.name+((m=m.version)?" "+m:""),v.test(x)?(/\bIE\b/.test(m)&&"Mac OS"==z&&(z=null),m="identify"+m):(m="mask"+m,x=T?c(T.replace(/([a-z])([A-Z])/g,"$1 $2")):"Opera",/\bIE\b/.test(m)&&(z=null),S||(p=null)),E=["Presto"],q.push(m));else x+=" Mobile";if(m=(/\bAppleWebKit\/([\d.]+\+?)/i.exec(a)||0)[1]){m=[parseFloat(m.replace(/\.(\d)$/,".0$1")),m];if("Safari"==x&&"+"==m[1].slice(-1))x="WebKit Nightly",V="alpha",p=m[1].slice(0,-1);else if(p==m[1]||p==(m[2]=
(/\bSafari\/([\d.]+\+?)/i.exec(a)||0)[1]))p=null;m[1]=(/\bChrome\/([\d.]+)/i.exec(a)||0)[1];537.36==m[0]&&537.36==m[2]&&28<=parseFloat(m[1])&&"WebKit"==E&&(E=["Blink"]);S&&(y||m[1])?(E&&(E[1]="like Chrome"),m=m[1]||(m=m[0],530>m?1:532>m?2:532.05>m?3:533>m?4:534.03>m?5:534.07>m?6:534.1>m?7:534.13>m?8:534.16>m?9:534.24>m?10:534.3>m?11:535.01>m?12:535.02>m?"13+":535.07>m?15:535.11>m?16:535.19>m?17:536.05>m?18:536.1>m?19:537.01>m?20:537.11>m?"21+":537.13>m?23:537.18>m?24:537.24>m?25:537.36>m?26:"Blink"!=
E?"27":"28")):(E&&(E[1]="like Safari"),m=(m=m[0],400>m?1:500>m?2:526>m?3:533>m?4:534>m?"4+":535>m?5:537>m?6:538>m?7:601>m?8:"8"));E&&(E[1]+=" "+(m+="number"==typeof m?".x":/[.+]/.test(m)?"":"+"));"Safari"==x&&(!p||45<parseInt(p))&&(p=m)}"Opera"==x&&(m=/\bzbov|zvav$/.exec(z))?(x+=" ",q.unshift("desktop mode"),"zvav"==m?(x+="Mini",p=null):x+="Mobile",z=z.replace(RegExp(" *"+m+"$"),"")):"Safari"==x&&/\bChrome\b/.exec(E&&E[1])&&(q.unshift("desktop mode"),x="Chrome Mobile",p=null,/\bOS X\b/.test(z)?(P=
"Apple",z="iOS 4.3+"):z=null);p&&0==p.indexOf(m=/[\d.]+$/.exec(z))&&-1<a.indexOf("/"+m+"-")&&(z=String(z.replace(m,"")).replace(/^ +| +$/g,""));E&&!/\b(?:Avant|Nook)\b/.test(x)&&(/Browser|Lunascape|Maxthon/.test(x)||"Safari"!=x&&/^iOS/.test(z)&&/\bSafari\b/.test(E[1])||/^(?:Adobe|Arora|Breach|Midori|Opera|Phantom|Rekonq|Rock|Samsung Internet|Sleipnir|Web)/.test(x)&&E[1])&&(m=E[E.length-1])&&q.push(m);q.length&&(q=["("+q.join("; ")+")"]);P&&F&&0>F.indexOf(P)&&q.push("on "+P);F&&q.push((/^on /.test(q[q.length-
1])?"":"on ")+F);if(z){var W=(m=/ ([\d.+]+)$/.exec(z))&&"/"==z.charAt(z.length-m[0].length-1);z={architecture:32,family:m&&!W?z.replace(m[0],""):z,version:m?m[1]:null,toString:function(){var a=this.version;return this.family+(a&&!W?" "+a:"")+(64==this.architecture?" 64-bit":"")}}}(m=/\b(?:AMD|IA|Win|WOW|x86_|x)64\b/i.exec(U))&&!/\bi686\b/i.test(U)?(z&&(z.architecture=64,z.family=z.family.replace(RegExp(" *"+m),"")),x&&(/\bWOW64\b/i.test(a)||S&&/\w(?:86|32)$/.test(w.cpuClass||w.platform)&&!/\bWin64; x64\b/i.test(a))&&
q.unshift("32-bit")):z&&/^OS X/.test(z.family)&&"Chrome"==x&&39<=parseFloat(p)&&(z.architecture=64);a||(a=null);g={};g.description=a;g.layout=E&&E[0];g.manufacturer=P;g.name=x;g.prerelease=V;g.product=F;g.ua=a;g.version=x&&p;g.os=z||{architecture:null,family:null,version:null,toString:function(){return"null"}};g.parse=d;g.toString=function(){return this.description||""};g.version&&q.unshift(p);g.name&&q.unshift(x);z&&x&&(z!=String(z).split(" ")[0]||z!=x.split(" ")[0]&&!F)&&q.push(F?"("+z+")":"on "+
z);q.length&&(g.description=q.join(" "));return g}var n={"function":!0,object:!0},r=n[typeof window]&&window||this,q=n[typeof exports]&&exports;n=n[typeof module]&&module&&!module.nodeType&&module;var g=q&&n&&"object"==typeof global&&global;!g||g.global!==g&&g.window!==g&&g.self!==g||(r=g);var w=Math.pow(2,53)-1,v=/\bOpera/;g=Object.prototype;var u=g.hasOwnProperty,t=g.toString,p=d();"function"==typeof define&&"object"==typeof define.amd&&define.amd?(r.platform=p,define(function(){return p})):q&&
n?f(p,function(a,b){q[b]=a}):r.platform=p}).call(this);
function buildIOSMeta(){for(var a=[{name:"viewport",content:"width=device-width, height=device-height, initial-scale=1, minimum-scale=1, maximum-scale=1, user-scalable=no"},{name:"apple-mobile-web-app-capable",content:"yes"},{name:"apple-mobile-web-app-status-bar-style",content:"black"}],e=0;e<a.length;e++){var c=document.createElement("meta");c.name=a[e].name;c.content=a[e].content;var f=window.document.head.querySelector('meta[name="'+c.name+'"]');f&&f.parentNode.removeChild(f);window.document.head.appendChild(c)}}
function hideIOSFullscreenPanel(){jQuery(".xxx-ios-fullscreen-message").css("display","none");jQuery(".xxx-ios-fullscreen-scroll").css("display","none");jQuery(".xxx-game-iframe-full").removeClass("xxx-game-iframe-iphone-se")}function buildIOSFullscreenPanel(){jQuery("body").append('<div class="xxx-ios-fullscreen-message"><div class="xxx-ios-fullscreen-swipe"></div></div><div class="xxx-ios-fullscreen-scroll"></div>')}
function showIOSFullscreenPanel(){jQuery(".xxx-ios-fullscreen-message").css("display","block");jQuery(".xxx-ios-fullscreen-scroll").css("display","block")}
function __iosResize(){window.scrollTo(0,0);if("iPhone"===platform.product)switch(window.devicePixelRatio){case 2:switch(window.innerWidth){case 568:320!==window.innerHeight&&jQuery(".xxx-game-iframe-full").addClass("xxx-game-iframe-iphone-se");break;case 667:375===window.innerHeight?hideIOSFullscreenPanel():showIOSFullscreenPanel();break;default:hideIOSFullscreenPanel()}break;case 3:switch(window.innerWidth){case 736:414===window.innerHeight?hideIOSFullscreenPanel():showIOSFullscreenPanel();break;
case 724:375===window.innerHeight?hideIOSFullscreenPanel():showIOSFullscreenPanel();break;default:hideIOSFullscreenPanel()}break;default:hideIOSFullscreenPanel()}}function iosResize(){__iosResize();setTimeout(function(){__iosResize()},500)}function iosInIframe(){try{return window.self!==window.top}catch(a){return!0}}$(document).ready(function(){platform&&"iPhone"===platform.product&&!iosInIframe()&&(buildIOSFullscreenPanel(),buildIOSMeta())});
jQuery(window).resize(function(){platform&&"iPhone"===platform.product&&!iosInIframe()&&iosResize()});var s_iScaleFactor=1,s_oCanvasLeft,s_oCanvasTop;
(function(a){(jQuery.browser=jQuery.browser||{}).mobile=/android|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(ad|hone|od)|iris|kindle|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|symbian|tablet|treo|up\.(browser|link)|vodafone|wap|webos|windows (ce|phone)|xda|xiino/i.test(a)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|e\-|e\/|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(di|rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|xda(\-|2|g)|yas\-|your|zeto|zte\-/i.test(a.substr(0,
4))})(navigator.userAgent||navigator.vendor||window.opera);$(window).resize(function(){sizeHandler()});function trace(a){console.log(a)}function isIOS(){for(var a="iPad Simulator;iPhone Simulator;iPod Simulator;iPad;iPhone;iPod".split(";");a.length;)if(navigator.platform===a.pop())return s_bIsIphone=!0;return s_bIsIphone=!1}
function getSize(a){var e=a.toLowerCase(),c=window.document,f=c.documentElement;if(void 0===window["inner"+a])a=f["client"+a];else if(window["inner"+a]!=f["client"+a]){var h=c.createElement("body");h.id="vpw-test-b";h.style.cssText="overflow:scroll";var l=c.createElement("div");l.id="vpw-test-d";l.style.cssText="position:absolute;top:-1000px";l.innerHTML="<style>@media("+e+":"+f["client"+a]+"px){body#vpw-test-b div#vpw-test-d{"+e+":7px!important}}</style>";h.appendChild(l);f.insertBefore(h,c.head);
a=7==l["offset"+a]?f["client"+a]:window["inner"+a];f.removeChild(h)}else a=window["inner"+a];return a}window.addEventListener("orientationchange",onOrientationChange);function onOrientationChange(){window.matchMedia("(orientation: portrait)").matches&&sizeHandler();window.matchMedia("(orientation: landscape)").matches&&sizeHandler()}function getIOSWindowHeight(){return document.documentElement.clientWidth/window.innerWidth*window.innerHeight}
function getHeightOfIOSToolbars(){var a=(0===window.orientation?screen.height:screen.width)-getIOSWindowHeight();return 1<a?a:0}
function sizeHandler(){window.scrollTo(0,1);if($("#canvas")){var a="safari"===platform.name.toLowerCase()?getIOSWindowHeight():getSize("Height");var e=getSize("Width");_checkOrientation(e,a);var c=Math.min(a/CANVAS_HEIGHT,e/CANVAS_WIDTH),f=Math.round(CANVAS_WIDTH*c);c=Math.round(CANVAS_HEIGHT*c);if(c<a){var h=a-c;c+=h;f+=CANVAS_WIDTH/CANVAS_HEIGHT*h}else f<e&&(h=e-f,f+=h,c+=CANVAS_HEIGHT/CANVAS_WIDTH*h);h=a/2-c/2;var l=e/2-f/2,k=CANVAS_WIDTH/f;if(l*k<-EDGEBOARD_X||h*k<-EDGEBOARD_Y)c=Math.min(a/(CANVAS_HEIGHT-
2*EDGEBOARD_Y),e/(CANVAS_WIDTH-2*EDGEBOARD_X)),f=CANVAS_WIDTH*c,c*=CANVAS_HEIGHT,h=(a-c)/2,l=(e-f)/2,k=CANVAS_WIDTH/f;s_iOffsetX=-1*l*k;s_iOffsetY=-1*h*k;0<=h&&(s_iOffsetY=0);0<=l&&(s_iOffsetX=0);null!==s_oGame&&s_oGame.refreshButtonPos();null!==s_oMenu&&s_oMenu.refreshButtonPos();null!==s_oLevelMenu&&s_oLevelMenu.refreshButtonPos();s_bMobile?($("#canvas").css("width",f+"px"),$("#canvas").css("height",c+"px")):(s_oStage.canvas.width=f,s_oStage.canvas.height=c,s_iScaleFactor=Math.min(f/CANVAS_WIDTH,
c/CANVAS_HEIGHT),s_oStage.scaleX=s_oStage.scaleY=s_iScaleFactor);0>h||(h=(a-c)/2);$("#canvas").css("top",h+"px");$("#canvas").css("left",l+"px");fullscreenHandler()}}
function _checkOrientation(a,e){s_bMobile&&ENABLE_CHECK_ORIENTATION&&(a>e?"landscape"===$(".orientation-msg-container").attr("data-orientation")?($(".orientation-msg-container").css("display","none"),s_oMain.startUpdate()):($(".orientation-msg-container").css("display","block"),s_oMain.stopUpdate()):"portrait"===$(".orientation-msg-container").attr("data-orientation")?($(".orientation-msg-container").css("display","none"),s_oMain.startUpdate()):($(".orientation-msg-container").css("display","block"),
s_oMain.stopUpdate()))}function createBitmap(a,e,c){var f=new createjs.Bitmap(a),h=new createjs.Shape;e&&c?h.graphics.beginFill("#fff").drawRect(0,0,e,c):h.graphics.beginFill("#ff0").drawRect(0,0,a.width,a.height);f.hitArea=h;return f}function createSprite(a,e,c,f,h,l){a=null!==e?new createjs.Sprite(a,e):new createjs.Sprite(a);e=new createjs.Shape;e.graphics.beginFill("#000000").drawRect(-c,-f,h,l);a.hitArea=e;return a}
function randomFloatBetween(a,e,c){"undefined"===typeof c&&(c=2);return parseFloat(Math.min(a+Math.random()*(e-a),e).toFixed(c))}function shuffle(a){for(var e=a.length,c,f;0!==e;)f=Math.floor(Math.random()*e),--e,c=a[e],a[e]=a[f],a[f]=c;return a}function formatTime(a){a/=1E3;var e=Math.floor(a/60);a=parseFloat(a-60*e).toFixed(1);var c="";c=10>e?c+("0"+e+":"):c+(e+":");return 10>a?c+("0"+a):c+a}
function NoClickDelay(a){this.element=a;window.Touch&&this.element.addEventListener("touchstart",this,!1)}function shuffle(a){for(var e=a.length,c,f;0<e;)f=Math.floor(Math.random()*e),e--,c=a[e],a[e]=a[f],a[f]=c;return a}
NoClickDelay.prototype={handleEvent:function(a){switch(a.type){case "touchstart":this.onTouchStart(a);break;case "touchmove":this.onTouchMove(a);break;case "touchend":this.onTouchEnd(a)}},onTouchStart:function(a){a.preventDefault();this.moved=!1;this.element.addEventListener("touchmove",this,!1);this.element.addEventListener("touchend",this,!1)},onTouchMove:function(a){this.moved=!0},onTouchEnd:function(a){this.element.removeEventListener("touchmove",this,!1);this.element.removeEventListener("touchend",
this,!1);if(!this.moved){a=document.elementFromPoint(a.changedTouches[0].clientX,a.changedTouches[0].clientY);3==a.nodeType&&(a=a.parentNode);var e=document.createEvent("MouseEvents");e.initEvent("click",!0,!0);a.dispatchEvent(e)}}};
(function(){function a(a){var c={focus:"visible",focusin:"visible",pageshow:"visible",blur:"hidden",focusout:"hidden",pagehide:"hidden"};a=a||window.event;a.type in c?document.body.className=c[a.type]:(document.body.className=this[e]?"hidden":"visible","hidden"===document.body.className?s_oMain.stopUpdate():s_oMain.startUpdate())}var e="hidden";e in document?document.addEventListener("visibilitychange",a):(e="mozHidden")in document?document.addEventListener("mozvisibilitychange",a):(e="webkitHidden")in
document?document.addEventListener("webkitvisibilitychange",a):(e="msHidden")in document?document.addEventListener("msvisibilitychange",a):"onfocusin"in document?document.onfocusin=document.onfocusout=a:window.onpageshow=window.onpagehide=window.onfocus=window.onblur=a})();function ctlArcadeResume(){null!==s_oMain&&s_oMain.startUpdate()}function ctlArcadePause(){null!==s_oMain&&s_oMain.stopUpdate()}
function getParamValue(a){for(var e=window.location.search.substring(1).split("&"),c=0;c<e.length;c++){var f=e[c].split("=");if(f[0]==a)return f[1]}}function playSound(a,e,c){return!1===DISABLE_SOUND_MOBILE||!1===s_bMobile?(s_aSounds[a].play(),s_aSounds[a].volume(e),s_aSounds[a].loop(c),s_aSounds[a]):null}function stopSound(a){!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||s_aSounds[a].stop()}function setVolume(a,e){!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||s_aSounds[a].volume(e)}
function setMute(a,e){!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||s_aSounds[a].mute(e)}function isSoundPlaying(a){return s_aSounds[a].playing()}function saveItem(a,e){s_bStorageAvailable&&localStorage.setItem(a,e)}function getItem(a){return s_bStorageAvailable?localStorage.getItem(a):null}
function fullscreenHandler(){ENABLE_FULLSCREEN&&!1!==screenfull.enabled&&(s_bFullscreen=screenfull.isFullscreen,null!==s_oInterface&&s_oInterface.resetFullscreenBut(),null!==s_oMenu&&s_oMenu.resetFullscreenBut(),null!==s_oLevelMenu&&s_oLevelMenu.resetFullscreenBut())}if(screenfull.enabled)screenfull.on("change",function(){s_bFullscreen=screenfull.isFullscreen;null!==s_oInterface&&s_oInterface.resetFullscreenBut();null!==s_oMenu&&s_oMenu.resetFullscreenBut();null!==s_oLevelMenu&&s_oLevelMenu.resetFullscreenBut()});
function CSpriteLibrary(){var a={},e,c,f,h,l,k;this.init=function(a,d,n){e={};f=c=0;h=a;l=d;k=n};this.addSprite=function(b,d){if(a.hasOwnProperty(b))return!1;var n=new Image;a[b]=e[b]={szPath:d,oSprite:n,bLoaded:!1};c++;return!0};this.getSprite=function(b){return a.hasOwnProperty(b)?a[b].oSprite:null};this._onSpritesLoaded=function(){c=0;l.call(k)};this._onSpriteLoaded=function(){h.call(k);++f===c&&this._onSpritesLoaded()};this.loadSprites=function(){for(var a in e)e[a].oSprite.oSpriteLibrary=this,
e[a].oSprite.szKey=a,e[a].oSprite.onload=function(){this.oSpriteLibrary.setLoaded(this.szKey);this.oSpriteLibrary._onSpriteLoaded(this.szKey)},e[a].oSprite.onerror=function(a){var b=a.currentTarget;setTimeout(function(){e[b.szKey].oSprite.src=e[b.szKey].szPath},500)},e[a].oSprite.src=e[a].szPath};this.setLoaded=function(b){a[b].bLoaded=!0};this.isLoaded=function(b){return a[b].bLoaded};this.getNumSprites=function(){return c}}
var CANVAS_WIDTH=1500,CANVAS_HEIGHT=768,EDGEBOARD_X=180,EDGEBOARD_Y=20,LOCALSTORAGE_STRING="rugbyrush_",FPS=30,FPS_TIME=1E3/FPS,DISABLE_SOUND_MOBILE=!1,FONT_GAME="impact",STATE_LOADING=0,STATE_MENU=1,STATE_MENU_LEVEL=2,STATE_SELECT_TEAM=3,STATE_GAME=4,ON_MOUSE_DOWN=0,ON_MOUSE_UP=1,ON_MOUSE_OVER=2,ON_MOUSE_OUT=3,ON_DRAG_START=4,ON_DRAG_END=5,ON_BUT_YES_DOWN=6,ON_PLAYER_TOUCHDOWN=7,ON_PLAYER_TACKLED=8,ON_OPPONENT_HIDE=9,ON_OPPONENT_TACKLE=10,ON_POWERUP_END_MOVE=11,ON_BACK_MENU=12,ON_RESTART=13,ON_NEXT_LEVEL=
14,ON_END_LOADING=15,ON_END_COUNTDOWN=16,PLAYER_ANIM_RUN=0,PLAYER_ANIM_FALL=1,PLAYER_ANIM_TOUCHDOWN=2,PLAYER_ANIM_JUMP=3,STARTING_STANDS_SCALE_BONUS=.74,NUM_LEVELS,NUM_TEAMS=12,OPPONENT_FINAL_Y=1070,POWERUP_FINAL_Y=600,TIME_OPPONENT_RUN=3E3,HERO_ACCELERATION,HERO_SUPER_ACCELERATION,HERO_FRICTION,MAX_HERO_SPEED,MAX_DIST_AVOID_OPPONENT_IN_JUMP=150,MIN_POWERUP_X=700,MAX_POWERUP_X=800,SCORE_POWERUP,TIME_EFFECT_POWERUP=1E4,NUM_COLS_PAGE_LEVEL=6,NUM_ROWS_PAGE_LEVEL=2,SOUNDTRACK_VOLUME_IN_GAME=.4,TEAM_EASY=
[0,2,5,11],TEAM_MEDIUM=[1,7,9],TEAM_HARD=[3,4,6,8,10],DEFAULT_TEAM_SEQ=[0,2,5,10,1,6,8,3,4,7,9],ENABLE_FULLSCREEN,ENABLE_CHECK_ORIENTATION,TEXT_SCORE="分數",TEXT_LEVEL_SCORE="關卡分數",TEXT_GAME_OVER="遊戲結束",TEXT_CONGRATS="您贏了!!",TEXT_ERR_LS="YOUR WEB BROWSER DOES NOT SUPPORT STORING SETTING LOCALLY. IN SAFARI, THE MOST COMMON CAUSE OF THIS IS USING 'PRIVATE BROWSING MODE'. SOME INFO MAY NOT SAVE OR SOME FEATURE MAY NOT WORK PROPERLY.",TEXT_CREDITS_DEVELOPED="DEVELOPED BY",TEXT_PRELOADER_CONTINUE=
"開始",TEXT_ARE_SURE="您確定嗎?",TEXT_SELECT_LEVEL="選擇對戰",TEXT_LEVEL="對戰",TEXT_LEVEL_CLEARED="對戰 %s 贏了",TEXT_JUMP="跳躍",TEXT_SELECT_TEAM="選擇您的團隊",TEXT_LOADING="載入中...",TEXT_PLAY="開始",TEXT_CONFIRM_DELETE="所有已儲存的內容都將被刪除！你確定嗎?",TEAM_NAMES="阿根廷;澳洲;斐濟;法國;威爾斯;日本;英國;愛爾蘭;紐西蘭;蘇格蘭;南非;烏拉圭".split(";"),TEXT_SHARE_IMAGE="200x200.jpg",TEXT_SHARE_TITLE="恭喜!",TEXT_SHARE_MSG1="您獲得 <strong>",
TEXT_SHARE_MSG2=" 分</strong>!<br><br>與您的好友分享獲得的分數!",TEXT_SHARE_SHARE1="我的分數是 ",TEXT_SHARE_SHARE2=" 分! 您能獲得更好的分數嗎?";
function CPreloader(){var a,e,c,f,h,l,k,b,d,n;this._init=function(){s_oSpriteLibrary.init(this._onImagesLoaded,this._onAllImagesLoaded,this);s_oSpriteLibrary.addSprite("progress_bar","./sprites/progress_bar.png");s_oSpriteLibrary.addSprite("200x200","./sprites/200x200.jpg");s_oSpriteLibrary.addSprite("but_start","./sprites/but_start.png");s_oSpriteLibrary.loadSprites();n=new createjs.Container;s_oStage.addChild(n)};this.unload=function(){n.removeAllChildren()};this._onImagesLoaded=function(){};this._onAllImagesLoaded=
function(){this.attachSprites();s_oMain.preloaderReady()};this.attachSprites=function(){var r=new createjs.Shape;r.graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);n.addChild(r);r=s_oSpriteLibrary.getSprite("200x200");k=createBitmap(r);k.regX=.5*r.width;k.regY=.5*r.height;k.x=CANVAS_WIDTH/2;k.y=CANVAS_HEIGHT/2-80;n.addChild(k);b=new createjs.Shape;b.graphics.beginFill("rgba(0,0,0,0.01)").drawRoundRect(k.x-100,k.y-100,200,200,10);n.addChild(b);k.mask=b;r=s_oSpriteLibrary.getSprite("progress_bar");
f=createBitmap(r);f.x=CANVAS_WIDTH/2-r.width/2;f.y=CANVAS_HEIGHT/2+70;n.addChild(f);a=r.width;e=r.height;h=new createjs.Shape;h.graphics.beginFill("rgba(0,0,0,0.01)").drawRect(f.x,f.y,1,e);n.addChild(h);f.mask=h;c=new createjs.Text("","30px "+FONT_GAME,"#fff");c.x=CANVAS_WIDTH/2;c.y=CANVAS_HEIGHT/2+120;c.textBaseline="alphabetic";c.textAlign="center";n.addChild(c);r=s_oSpriteLibrary.getSprite("but_start");d=new CTextButton(CANVAS_WIDTH/2,CANVAS_HEIGHT/2+100,r,TEXT_PRELOADER_CONTINUE,"Arial","#000",
36,"center",0,n);d.addEventListener(ON_MOUSE_UP,this._onButStartRelease,this);d.setVisible(!1);l=new createjs.Shape;l.graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);n.addChild(l);createjs.Tween.get(l).to({alpha:0},500).call(function(){createjs.Tween.removeTweens(l);n.removeChild(l)})};this._onButStartRelease=function(){s_oMain._allResourcesLoaded()};this.refreshLoader=function(b){c.text=b+"%";100===b&&(s_oMain._allResourcesLoaded(),c.visible=!1,f.visible=!1);h.graphics.clear();
b=Math.floor(b*a/100);h.graphics.beginFill("rgba(0,0,0,0.01)").drawRect(f.x,f.y,b,e)};this._init()}
function CMain(a){var e,c,f=0,h=0,l=STATE_LOADING,k,b;this.initContainer=function(){var a=document.getElementById("canvas");s_oStage=new createjs.Stage(a);s_oStage.preventSelection=!1;createjs.Touch.enable(s_oStage);s_bMobile=jQuery.browser.mobile;!1===s_bMobile&&s_oStage.enableMouseOver(20);s_iPrevTime=(new Date).getTime();createjs.Ticker.framerate=FPS;createjs.Ticker.on("tick",this._update);navigator.userAgent.match(/Windows Phone/i)&&(DISABLE_SOUND_MOBILE=!0);s_oSpriteLibrary=new CSpriteLibrary;
s_oLevelSettings=new CLevelSettings;seekAndDestroy()?k=new CPreloader:window.location.href="http://www.codethislab.com/contact-us.html";s_aTeamLoaded=[];for(a=0;a<NUM_TEAMS;a++)s_aTeamLoaded[a]=!1};this.preloaderReady=function(){!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||this._initSounds();this._loadImages();e=c=!0};this.soundLoaded=function(){f++;k.refreshLoader(Math.floor(f/h*100))};this._initSounds=function(){Howler.mute(!s_bAudioActive);s_aSoundsInfo=[];s_aSoundsInfo.push({path:"./sounds/",filename:"click",
loop:!1,volume:1,ingamename:"click"});s_aSoundsInfo.push({path:"./sounds/",filename:"level_win",loop:!1,volume:1,ingamename:"level_win"});s_aSoundsInfo.push({path:"./sounds/",filename:"powerup",loop:!1,volume:1,ingamename:"powerup"});s_aSoundsInfo.push({path:"./sounds/",filename:"crowd_touchdown",loop:!1,volume:1,ingamename:"crowd_touchdown"});s_aSoundsInfo.push({path:"./sounds/",filename:"enemy",loop:!1,volume:1,ingamename:"enemy"});s_aSoundsInfo.push({path:"./sounds/",filename:"enemy_tackle",loop:!1,
volume:1,ingamename:"enemy_tackle"});s_aSoundsInfo.push({path:"./sounds/",filename:"game_over",loop:!1,volume:1,ingamename:"game_over"});s_aSoundsInfo.push({path:"./sounds/",filename:"crowd_idle",loop:!0,volume:1,ingamename:"crowd_idle"});s_aSoundsInfo.push({path:"./sounds/",filename:"countdown_1",loop:!0,volume:1,ingamename:"countdown_1"});s_aSoundsInfo.push({path:"./sounds/",filename:"countdown_2",loop:!0,volume:1,ingamename:"countdown_2"});s_aSoundsInfo.push({path:"./sounds/",filename:"countdown_3",
loop:!0,volume:1,ingamename:"countdown_3"});s_aSoundsInfo.push({path:"./sounds/",filename:"go",loop:!0,volume:1,ingamename:"go"});s_aSoundsInfo.push({path:"./sounds/",filename:"soundtrack",loop:!0,volume:1,ingamename:"soundtrack"});h+=s_aSoundsInfo.length;s_aSounds=[];for(var a=0;a<s_aSoundsInfo.length;a++)this.tryToLoadSound(s_aSoundsInfo[a],!1)};this.tryToLoadSound=function(a,b){setTimeout(function(){s_aSounds[a.ingamename]=new Howl({src:[a.path+a.filename+".mp3"],autoplay:!1,preload:!0,loop:a.loop,
volume:a.volume,onload:s_oMain.soundLoaded,onloaderror:function(a,b){for(var d=0;d<s_aSoundsInfo.length;d++)if(a===s_aSounds[s_aSoundsInfo[d].ingamename]._sounds[0]._id){s_oMain.tryToLoadSound(s_aSoundsInfo[d],!0);break}},onplayerror:function(a){for(var b=0;b<s_aSoundsInfo.length;b++)if(a===s_aSounds[s_aSoundsInfo[b].ingamename]._sounds[0]._id){s_aSounds[s_aSoundsInfo[b].ingamename].once("unlock",function(){s_aSounds[s_aSoundsInfo[b].ingamename].play();"soundtrack"===s_aSoundsInfo[b].ingamename&&
null!==s_oGame&&setVolume("soundtrack",SOUNDTRACK_VOLUME_IN_GAME)});break}}})},b?200:0)};this._loadImages=function(){s_oSpriteLibrary.init(this._onImagesLoaded,this._onAllImagesLoaded,this);s_oSpriteLibrary.addSprite("but_play","./sprites/but_play.png");s_oSpriteLibrary.addSprite("but_next","./sprites/but_next.png");s_oSpriteLibrary.addSprite("but_exit","./sprites/but_exit.png");s_oSpriteLibrary.addSprite("bg_menu","./sprites/bg_menu.jpg");s_oSpriteLibrary.addSprite("audio_icon","./sprites/audio_icon.png");
s_oSpriteLibrary.addSprite("msg_box","./sprites/msg_box.png");s_oSpriteLibrary.addSprite("msg_box_big","./sprites/msg_box_big.png");s_oSpriteLibrary.addSprite("msg_box_wide","./sprites/msg_box_wide.png");s_oSpriteLibrary.addSprite("bg_game","./sprites/bg_game.jpg");s_oSpriteLibrary.addSprite("bg_menu_level","./sprites/bg_menu_level.jpg");s_oSpriteLibrary.addSprite("bg_menu_level","./sprites/bg_menu_level.jpg");s_oSpriteLibrary.addSprite("logo_ctl","./sprites/logo_ctl.png");s_oSpriteLibrary.addSprite("but_credits",
"./sprites/but_credits.png");s_oSpriteLibrary.addSprite("but_yes","./sprites/but_yes.png");s_oSpriteLibrary.addSprite("but_no","./sprites/but_no.png");s_oSpriteLibrary.addSprite("but_fullscreen","./sprites/but_fullscreen.png");s_oSpriteLibrary.addSprite("but_settings","./sprites/but_settings.png");s_oSpriteLibrary.addSprite("but_home","./sprites/but_home.png");s_oSpriteLibrary.addSprite("but_restart","./sprites/but_restart.png");s_oSpriteLibrary.addSprite("key_0","./sprites/key_0.png");s_oSpriteLibrary.addSprite("key_1",
"./sprites/key_1.png");s_oSpriteLibrary.addSprite("key_2","./sprites/key_2.png");s_oSpriteLibrary.addSprite("but_left","./sprites/but_left.png");s_oSpriteLibrary.addSprite("but_right","./sprites/but_right.png");s_oSpriteLibrary.addSprite("but_jump","./sprites/but_jump.png");s_oSpriteLibrary.addSprite("post","./sprites/post.png");s_oSpriteLibrary.addSprite("power_up_0","./sprites/power_up_0.png");s_oSpriteLibrary.addSprite("power_up_1","./sprites/power_up_1.png");s_oSpriteLibrary.addSprite("but_level",
"./sprites/but_level.png");s_oSpriteLibrary.addSprite("powerup_gui_off","./sprites/powerup_gui_off.png");s_oSpriteLibrary.addSprite("powerup_gui_on","./sprites/powerup_gui_on.png");s_oSpriteLibrary.addSprite("but_delete_save","./sprites/but_delete_save.png");s_oSpriteLibrary.addSprite("countdown_0","./sprites/countdown_0.png");s_oSpriteLibrary.addSprite("countdown_1","./sprites/countdown_1.png");s_oSpriteLibrary.addSprite("countdown_2","./sprites/countdown_2.png");s_oSpriteLibrary.addSprite("countdown_3",
"./sprites/countdown_3.png");s_oSpriteLibrary.addSprite("progress_loading","./sprites/progress_loading.png");s_oSpriteLibrary.addSprite("flags","./sprites/flags.png");s_oSpriteLibrary.addSprite("team_selection","./sprites/team_selection.png");s_oSpriteLibrary.addSprite("but_go","./sprites/but_go.png");for(var a=0;a<NUM_TEAMS;a++)s_oSpriteLibrary.addSprite("team_"+a,"./sprites/player_team_panels/team_"+a+".png"),s_oSpriteLibrary.addSprite("but_flag_"+a,"./sprites/but_flag_"+a+".png");for(a=0;18>a;a++)s_oSpriteLibrary.addSprite("field_loop_"+
a,"./sprites/field_loop/field_loop_"+a+".png");for(a=0;39>a;a++)s_oSpriteLibrary.addSprite("end_zone_"+a,"./sprites/end_zone/end_zone_"+a+".png");h+=s_oSpriteLibrary.getNumSprites();s_oSpriteLibrary.loadSprites()};this._onImagesLoaded=function(){f++;k.refreshLoader(Math.floor(f/h*100))};this._onAllImagesLoaded=function(){};this._allResourcesLoaded=function(){k.unload();try{saveItem(LOCALSTORAGE_STRING+"ls_available","ok")}catch(d){s_bStorageAvailable=!1}s_oSoundTrack=playSound("soundtrack",1,!0);
s_oMain.gotoMenu()};this.createOpponentSeq=function(){if(s_bStorageAvailable){s_aTeamSeq=[];for(var a=[],b=0;b<TEAM_EASY.length;b++)a[b]=TEAM_EASY[b];var e=[];for(b=0;b<TEAM_MEDIUM.length;b++)e[b]=TEAM_MEDIUM[b];var c=[];for(b=0;b<TEAM_HARD.length;b++)c[b]=TEAM_HARD[b];-1!==a.indexOf(s_iTeamSelected)?a.splice(a.indexOf(s_iTeamSelected),1):-1!==e.indexOf(s_iTeamSelected)?e.splice(e.indexOf(s_iTeamSelected),1):-1!==c.indexOf(s_iTeamSelected)&&c.splice(c.indexOf(s_iTeamSelected),1);a=shuffle(a);s_aTeamSeq=
s_aTeamSeq.concat(a);e=shuffle(e);s_aTeamSeq=s_aTeamSeq.concat(e);c=shuffle(c);s_aTeamSeq=s_aTeamSeq.concat(c);setTeam();setOpponentSeq()}else DEFAULT_TEAM_SEQ.splice(DEFAULT_TEAM_SEQ.indexOf(s_iTeamSelected),1),s_aTeamSeq=DEFAULT_TEAM_SEQ};this.gotoMenu=function(){new CMenu;l=STATE_MENU};this.gotoLevelMenu=function(){new CLevelMenu;l=STATE_MENU_LEVEL};this.gotoChooseMenu=function(){new CChooseMenu;l=STATE_SELECT_TEAM};this.gotoGame=function(){b=new CGame;l=STATE_GAME};this.levelSelected=function(a){s_iLevelSelected=
a;trace("level selected "+s_iLevelSelected);a>=s_iLastLevel&&(s_iLastLevel=a)};this.stopUpdateNoBlockAndTick=function(){c=!1};this.startUpdateNoBlockAndTick=function(){c=!0};this.stopUpdateNoBlock=function(){e=!1;createjs.Ticker.paused=!0};this.startUpdateNoBlock=function(){s_iPrevTime=(new Date).getTime();e=!0;createjs.Ticker.paused=!1};this.stopUpdate=function(){e=!1;createjs.Ticker.paused=!0;$("#block_game").css("display","block");!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||Howler.mute(!0)};this.startUpdate=
function(){s_iPrevTime=(new Date).getTime();e=!0;createjs.Ticker.paused=!1;$("#block_game").css("display","none");(!1===DISABLE_SOUND_MOBILE||!1===s_bMobile)&&s_bAudioActive&&Howler.mute(!1)};this._update=function(a){if(!1!==e){var d=(new Date).getTime();s_iTimeElaps=d-s_iPrevTime;s_iCntTime+=s_iTimeElaps;s_iCntFps++;s_iPrevTime=d;1E3<=s_iCntTime&&(s_iCurFps=s_iCntFps,s_iCntTime-=1E3,s_iCntFps=0);l===STATE_GAME&&c&&b.update();void 0!==s_oStage&&s_oStage.update(a)}};s_oMain=this;HERO_ACCELERATION=
a.hero_acceleration;HERO_SUPER_ACCELERATION=a.hero_acceleration_powerup;HERO_FRICTION=a.hero_friction;MAX_HERO_SPEED=a.max_hero_speed;SCORE_POWERUP=a.score_powerup;s_bAudioActive=a.audio_enable_on_startup;ENABLE_FULLSCREEN=a.fullscreen;ENABLE_CHECK_ORIENTATION=a.check_orientation;this.initContainer()}
var s_bMobile,s_bAudioActive=!1,s_iCntTime=0,s_iTimeElaps=0,s_iPrevTime=0,s_iCntFps=0,s_iCurFps=0,s_oSoundTrack=null,s_oDrawLayer,s_oStage,s_oMain=null,s_oSpriteLibrary,s_oLevelSettings,s_iLastLevel=1,s_iLevelSelected=1,s_bFullscreen=!1,s_bStorageAvailable=!0,s_aSoundsInfo,s_aTeamLoaded,s_aTeamSeq,s_iTeamSelected=0;
function CTextButton(a,e,c,f,h,l,k,b,d,n){var r,q,g,w,v,u,t,p,y,B;this._init=function(a,b,d,e,c,f,h,k,l){r=!1;q=1;g=[];w=[];B=createBitmap(d);p=new createjs.Container;p.x=a;p.y=b;p.regX=d.width/2;p.regY=d.height/2;s_bMobile||(p.cursor="pointer");p.addChild(B,y);n.addChild(p);y=new CTLText(p,10,5,d.width-20,d.height-10,h,k,f,c,1,l,0,e,!0,!0,!1,!1);this._initListener()};this.unload=function(){p.off("mousedown",v);p.off("pressup",u);n.removeChild(p)};this.setVisible=function(a){p.visible=a};this.setAlign=
function(a){y.textAlign=a};this.setTextX=function(a){y.x=a};this.setScale=function(a){q=p.scaleX=p.scaleY=a};this.enable=function(){r=!1};this.disable=function(){r=!0};this._initListener=function(){v=p.on("mousedown",this.buttonDown);u=p.on("pressup",this.buttonRelease)};this.addEventListener=function(a,b,d){g[a]=b;w[a]=d};this.addEventListenerWithParams=function(a,b,d,e){g[a]=b;w[a]=d;t=e};this.buttonRelease=function(){r||(playSound("click",1,!1),p.scaleX=q,p.scaleY=q,g[ON_MOUSE_UP]&&g[ON_MOUSE_UP].call(w[ON_MOUSE_UP],
t))};this.buttonDown=function(){r||(p.scaleX=.9*q,p.scaleY=.9*q,g[ON_MOUSE_DOWN]&&g[ON_MOUSE_DOWN].call(w[ON_MOUSE_DOWN]))};this.setPosition=function(a,b){p.x=a;p.y=b};this.tweenPosition=function(a,b,d,e,c,g,f){createjs.Tween.get(p).wait(e).to({x:a,y:b},d,c).call(function(){void 0!==g&&g.call(f)})};this.changeText=function(a){y.refreshText(a)};this.setX=function(a){p.x=a};this.setY=function(a){p.y=a};this.getButtonImage=function(){return p};this.getX=function(){return p.x};this.getY=function(){return p.y};
this.getSprite=function(){return p};this.getScale=function(){return p.scaleX};this._init(a,e,c,f,h,l,k,b,d)}
function CGfxButton(a,e,c,f){var h,l,k,b=[],d,n,r;this._init=function(a,b,d){h=!1;l=[];k=[];r=createBitmap(d);r.x=a;r.y=b;r.regX=d.width/2;r.regY=d.height/2;r.cursor="pointer";f.addChild(r);this._initListener()};this.unload=function(){r.off("mousedown",d);r.off("pressup",n);f.removeChild(r)};this.setVisible=function(a){r.visible=a};this._initListener=function(){d=r.on("mousedown",this.buttonDown);n=r.on("pressup",this.buttonRelease)};this.addEventListener=function(a,b,d){l[a]=b;k[a]=d};this.addEventListenerWithParams=
function(a,d,e,c){l[a]=d;k[a]=e;b=c};this.enable=function(){h=!1};this.disable=function(){h=!0};this.buttonRelease=function(){h||(playSound("click",1,!1),r.scaleX=1,r.scaleY=1,l[ON_MOUSE_UP]&&l[ON_MOUSE_UP].call(k[ON_MOUSE_UP],b))};this.buttonDown=function(){h||(r.scaleX=.9,r.scaleY=.9,l[ON_MOUSE_DOWN]&&l[ON_MOUSE_DOWN].call(k[ON_MOUSE_DOWN],b))};this.setPosition=function(a,b){r.x=a;r.y=b};this.setX=function(a){r.x=a};this.setY=function(a){r.y=a};this.getButtonImage=function(){return r};this.getX=
function(){return r.x};this.getY=function(){return r.y};this._init(a,e,c);return this}
function CToggle(a,e,c,f,h){var l,k,b,d;this._init=function(a,e,c,g){k=[];b=[];var f=new createjs.SpriteSheet({images:[c],frames:{width:c.width/2,height:c.height,regX:c.width/2/2,regY:c.height/2},animations:{state_true:[0],state_false:[1]}});l=g;d=createSprite(f,"state_"+l,c.width/2/2,c.height/2,c.width/2,c.height);d.x=a;d.y=e;d.stop();d.cursor="pointer";h.addChild(d);this._initListener()};this.unload=function(){d.off("mousedown",this.buttonDown);d.off("pressup",this.buttonRelease);h.removeChild(d)};
this._initListener=function(){d.on("mousedown",this.buttonDown);d.on("pressup",this.buttonRelease)};this.addEventListener=function(a,d,c){k[a]=d;b[a]=c};this.setActive=function(a){l=a;d.gotoAndStop("state_"+l)};this.buttonRelease=function(){d.scaleX=1;d.scaleY=1;playSound("click",1,!1);l=!l;d.gotoAndStop("state_"+l);k[ON_MOUSE_UP]&&k[ON_MOUSE_UP].call(b[ON_MOUSE_UP],l)};this.buttonDown=function(){d.scaleX=.9;d.scaleY=.9;k[ON_MOUSE_DOWN]&&k[ON_MOUSE_DOWN].call(b[ON_MOUSE_DOWN])};this.setPosition=function(a,
b){d.x=a;d.y=b};this.getButtonImage=function(){return d};this._init(a,e,c,f)}
function CMenu(){var a,e,c,f,h,l,k,b,d,n,r,q,g=null,w,v,u,t=null,p=null,y;this._init=function(){d=createBitmap(s_oSpriteLibrary.getSprite("bg_menu"));s_oStage.addChild(d);n=new CGfxButton(CANVAS_WIDTH/2-200,CANVAS_HEIGHT-160,s_oSpriteLibrary.getSprite("but_play"),s_oStage);n.addEventListener(ON_MOUSE_UP,this._onButPlaySingle,this);if(!1===DISABLE_SOUND_MOBILE||!1===s_bMobile){var B=s_oSpriteLibrary.getSprite("audio_icon");k=CANVAS_WIDTH-B.height/2-10;b=B.height/2+10;r=new CToggle(k,b,B,s_bAudioActive,
s_oStage);r.addEventListener(ON_MOUSE_UP,this._onAudioToggle,this)}B=s_oSpriteLibrary.getSprite("but_credits");h=B.width/2+10;l=B.height/2+10;q=new CGfxButton(h,l,B,s_oStage);q.addEventListener(ON_MOUSE_UP,this._onButCreditsRelease,this);B=window.document;var A=B.documentElement;t=A.requestFullscreen||A.mozRequestFullScreen||A.webkitRequestFullScreen||A.msRequestFullscreen;p=B.exitFullscreen||B.mozCancelFullScreen||B.webkitExitFullscreen||B.msExitFullscreen;!1===ENABLE_FULLSCREEN&&(t=!1);t&&screenfull.enabled&&
(B=s_oSpriteLibrary.getSprite("but_fullscreen"),c=h+B.width/2+10,f=l,u=new CToggle(c,f,B,s_bFullscreen,s_oStage),u.addEventListener(ON_MOUSE_UP,this._onFullscreenRelease,this));s_bStorageAvailable&&null!==getStoredTeamSelected()&&(B=s_oSpriteLibrary.getSprite("but_delete_save"),a=B.width/2+10,e=CANVAS_HEIGHT-B.height/2-10,g=new CGfxButton(a,e,B,s_oStage),g.addEventListener(ON_MOUSE_UP,this._onDelete,this),s_iTeamSelected=getStoredTeamSelected(),s_aTeamSeq=getOpponentSeq(),s_iLastLevel=getSavedLevel(),
trace("s_iLastLevel "+s_iLastLevel));s_bStorageAvailable||new CAlertSavingBox(TEXT_ERR_LS,s_oStage);v=new CAreYouSurePanel;v.addEventListener(ON_BUT_YES_DOWN,this._onConfirmDelete,this);y=new CLoaderResourcesPanel(s_oStage);y.addEventListener(ON_END_LOADING,this._onEndLoading,this);w=new createjs.Shape;w.graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);s_oStage.addChild(w);createjs.Tween.get(w).to({alpha:0},400).call(function(){w.visible=!1});setVolume("soundtrack",1);this.refreshButtonPos()};
this.unload=function(){y.unload();n.unload();q.unload();null!==g&&g.unload();if(!1===DISABLE_SOUND_MOBILE||!1===s_bMobile)r.unload(),r=null;t&&screenfull.enabled&&u.unload();s_oStage.removeAllChildren();s_oMenu=null};this.refreshButtonPos=function(){!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||r.setPosition(k-s_iOffsetX,s_iOffsetY+b);t&&screenfull.enabled&&u.setPosition(c+s_iOffsetX,f+s_iOffsetY);q.setPosition(h+s_iOffsetX,l+s_iOffsetY);null!==g&&g.setPosition(a+s_iOffsetX,e-s_iOffsetY)};this._onButPlaySingle=
function(){if(null===g)s_oMenu.unload(),s_oMain.gotoChooseMenu();else if(s_aTeamLoaded[s_iTeamSelected])s_oMenu.unload(),s_oMain.gotoLevelMenu();else{for(var a=[],b=0;2>b;b++)a.push({name:"player"+s_iTeamSelected+"_run_"+b,path:"./sprites/player_"+s_iTeamSelected+"/player"+s_iTeamSelected+"_run_"+b+".png"});for(b=0;6>b;b++)a.push({name:"player"+s_iTeamSelected+"_touchdown_"+b,path:"./sprites/player_"+s_iTeamSelected+"/player"+s_iTeamSelected+"_touchdown_"+b+".png"});for(b=0;7>b;b++)a.push({name:"player"+
s_iTeamSelected+"_jump_"+b,path:"./sprites/player_"+s_iTeamSelected+"/player"+s_iTeamSelected+"_jump_"+b+".png"});a.push({name:"player"+s_iTeamSelected+"_falling",path:"./sprites/player_"+s_iTeamSelected+"/player"+s_iTeamSelected+"_falling.png"});y.start(a)}$(s_oMain).trigger("start_session")};this._onEndLoading=function(){s_aTeamLoaded[s_iTeamSelected]=!0;s_oMenu.unload();s_oMain.gotoLevelMenu()};/*this._onButCreditsRelease=function(){new CCreditsPanel};*/this._onAudioToggle=function(){Howler.mute(s_bAudioActive);
s_bAudioActive=!s_bAudioActive};this.resetFullscreenBut=function(){t&&screenfull.enabled&&u.setActive(s_bFullscreen)};this._onFullscreenRelease=function(){s_bFullscreen?p.call(window.document):t.call(window.document.documentElement);sizeHandler()};this._onDelete=function(){v.show(TEXT_CONFIRM_DELETE)};this._onConfirmDelete=function(){clearLocalStorage();g.unload();g=null};s_oMenu=this;this._init()}var s_oMenu=null;
function CGame(){var a=!1,e,c,f,h,l,k,b,d,n,r,q,g,w,v,u,t,p,y,B,A,M,J,H,R,Q,L,G,I,D,O,N,K,C;this._init=function(){b=s_iLevelSelected;l=getScoreTillLevel(b);trace("tot score "+l+" at level "+b);M=[{x:10,y:0},{x:-20,y:0},{x:10,y:-10},{x:0,y:20},{x:10,y:-10},{x:-10,y:0},{x:10,y:0},{x:-20,y:0},{x:10,y:-10},{x:0,y:20},{x:10,y:-10},{x:-10,y:0}];G=new createjs.Container;s_oStage.addChild(G);var a=s_oSpriteLibrary.getSprite("bg_game");J=createBitmap(a);J.regX=a.width/2;J.regY=a.height;J.x=CANVAS_WIDTH/2;
J.y=521;G.addChild(J);R=new CField(0,516,G);R.show();Q=new CFieldEndZone(0,516,G);a=s_oSpriteLibrary.getSprite("post");H=createBitmap(a);H.regX=a.width/2;H.regY=a.height;H.x=CANVAS_WIDTH-450;H.y=518;G.addChild(H);I=new createjs.Container;G.addChild(I);D=new CPlayer(CANVAS_WIDTH/2,CANVAS_HEIGHT-s_iOffsetY,G);D.addEventListener(ON_PLAYER_TOUCHDOWN,this._onWinLevel,this);D.addEventListener(ON_PLAYER_TACKLED,this._onEndLevel,this);L=new CInterface(l);O=new CHelpPanel;C=new CCountdownController(CANVAS_WIDTH/
2,CANVAS_HEIGHT/2,s_oStage);C.addEventListener(ON_END_COUNTDOWN,this.endCountDown,this);this.reset();1===b?O.show():s_oGame.startCountdown();N=new CEndPanel;N.addEventListener(ON_RESTART,this.restart,this);N.addEventListener(ON_BACK_MENU,this.onExit,this);K=new CNextLevelPanel;K.addEventListener(ON_RESTART,this.restart,this);K.addEventListener(ON_BACK_MENU,this.onExit,this);K.addEventListener(ON_NEXT_LEVEL,this._onNextLevel,this);playSound("crowd_idle",1,!0)};this.unload=function(){a=!1;stopSound("crowd_idle");
L.unload();s_oStage.removeAllChildren()};this.reset=function(){e=h=c=f=!1;d=k=0;p=[];y=[];n=s_oLevelSettings.getEnemiesSpawn(b);r=s_oLevelSettings.getStartingEnemySpawn(b);q=s_oLevelSettings.getEnemySpawnNumber(b);A=s_oLevelSettings.getPowerUps(b);l=getScoreTillLevel(b);g=parseFloat(((1-STARTING_STANDS_SCALE_BONUS)/n).toFixed(3));t=s_aTeamSeq[b-1];this._createSpawnArray();Q.reset();D.reset();L.reset(l,b);C.reset();J.scaleX=J.scaleY=STARTING_STANDS_SCALE_BONUS;H.scaleX=H.scaleY=.2;setVolume("crowd_idle",
1);setVolume("soundtrack",SOUNDTRACK_VOLUME_IN_GAME);$(s_oMain).trigger("start_level",b)};this.restart=function(){$(s_oMain).trigger("restart_level",b);for(var a=0;a<y.length;a++)y[a].unload();this.reset();this.startCountdown()};this.refreshButtonPos=function(){L.refreshButtonPos();D.setY(CANVAS_HEIGHT-s_iOffsetY)};this.onKeyDown=function(a){if(D.isJumping()||D.getCurAnim()===PLAYER_ANIM_TOUCHDOWN)return a.preventDefault(),!1;a||(a=window.event);switch(a.keyCode){case 37:c=!0;D.moveLeft(!0);break;
case 39:c=!0;D.moveRight(!0);break;case 32:c=!0,N.isVisible()?N._onRestart():O.isVisible()?O._onStart():K.isVisible()?K._onNext():(trace("_oPlayer.getCurAnim() "+D.getCurAnim()),D.jump())}a.preventDefault();return!1};this.onKeyUp=function(a){if(h)return a.preventDefault(),!1;a||(a=window.event);c=!1;switch(a.keyCode){case 37:D.moveLeft(!1);break;case 39:D.moveRight(!1)}a.preventDefault();return!1};this.moveLeft=function(a){a&&(c||D.isJumping())||h||(c=a,D.moveLeft(a))};this.moveRight=function(a){a&&
(c||D.isJumping())||h||(c=a,D.moveRight(a))};this.moveJump=function(a){a&&(c||D.isJumping())||h||D.getCurAnim()===PLAYER_ANIM_TOUCHDOWN||(c=a)&&D.jump()};this._createSpawnArray=function(){B=[];var a=s_iOffsetX+50,d=Math.floor(Math.random()*(CANVAS_WIDTH-s_iOffsetX-s_iOffsetX+1))+s_iOffsetX+50;for(d/=s_oLevelSettings.getEnemiesSpawn(b);a<CANVAS_WIDTH-s_iOffsetX;)B.push(a),a+=d;B=shuffle(B)};this.startCountdown=function(){C.start();D.show();f=a=!0};this.endCountDown=function(){L._initKeyListeners();
d=0;f=!1;this._spawnEnemy()};this._spawnEnemy=function(){for(var a=Math.floor(Math.random()*q)+1,b=0;b<a&&0!==n;b++){n--;var d=!1;0===n&&(f=d=!0);d=new COpponent(d,t,B.pop(),526,I);d.addEventListener(ON_OPPONENT_HIDE,this.checkTouchDown,this);d.addEventListener(ON_OPPONENT_TACKLE,this.checkCollision,this);p.push(d);d=J.scaleX+g;(new createjs.Tween.get(J)).to({scaleX:d,scaleY:d},r);d=H.scaleX+g;(new createjs.Tween.get(H)).to({scaleX:d,scaleY:d,x:H.x+750*g},r);-1!==A.indexOf(p.length)&&this._spawnPowerUp()}};
this._spawnPowerUp=function(){var a=new CPowerUp(Math.floor(Math.random()*(MAX_POWERUP_X-MIN_POWERUP_X+1))+MIN_POWERUP_X,510,Math.floor(2*Math.random()),I);a.addEventListener(ON_POWERUP_END_MOVE,this._checkCollisionWithPowerUp,this);y.push(a)};this.checkTouchDown=function(a){a&&!h&&this._showTouchdown()};this.checkCollision=function(a){if(!h){var b=D.getRect(),d=Math.abs(a.x-b.x);if(b.intersects(a))if(D.isJumping()&&d>MAX_DIST_AVOID_OPPONENT_IN_JUMP)this.refreshScore(Math.floor(d/200));else{h=!0;
w=0;var c=this;v=setInterval(function(){c.tremble()},20);playSound("enemy_tackle",1,!1);D.changeAnim(PLAYER_ANIM_FALL);for(a=0;a<y.length;a++)y[a].stopTween()}else this.refreshScore(Math.floor(d/200))}};this._checkCollisionWithPowerUp=function(a,b){if(!h&&D.getRect().intersects(a))switch(playSound("powerup",1,!1),b){case 0:this.refreshScore(SCORE_POWERUP);new CScoreText(SCORE_POWERUP,CANVAS_WIDTH/2,CANVAS_HEIGHT/2,s_oStage);break;case 1:D.setAcceleration(HERO_SUPER_ACCELERATION,2*MAX_HERO_SPEED),
u=0,e=!0,L.showPowerUpGui()}};this.tremble=function(){var a=M[w];G.x+=a.x;G.y+=a.y;w++;w===M.length&&(w=0,clearInterval(v))};this.refreshScore=function(a){k+=a;l+=a;L.refreshScore(l)};this._showTouchdown=function(){playSound("crowd_touchdown",1,!1);Q.show();var a=J.scaleX+g;(new createjs.Tween.get(J)).to({scaleX:a,scaleY:a},1200);a=H.scaleX+g;(new createjs.Tween.get(H)).to({scaleX:a,scaleY:a,x:H.x+500,y:H.y+60},1E3);setTimeout(function(){D.changeAnim(PLAYER_ANIM_TOUCHDOWN)},500)};this._manageOpponentDepth=
function(){I.sortChildren(function(a,b,d){return a.y>b.y?1:a.y<b.y?-1:0})};this.endZonePlayed=function(){};this._onEndLevel=function(){$(s_oMain).trigger("end_level",b);setVolume("crowd_idle",0);setTimeout(function(){N.show(l,TEXT_GAME_OVER)},2E3)};this._onWinLevel=function(){setVolume("crowd_idle",0);$(s_oMain).trigger("end_level",b);$(s_oMain).trigger("save_score",l);b===NUM_LEVELS?setTimeout(function(){N.show(l,TEXT_CONGRATS)},2E3):(setLocalStorageLevel(b+1),setLocalStorageScore(k,b),setTimeout(function(){K.show(k,
l,b)},2E3))};this._onNextLevel=function(){s_oGame.unload();s_oMain.gotoLevelMenu()};this.onExit=function(){this.unload();s_oMain.gotoMenu();$(s_oMain).trigger("show_interlevel_ad");$(s_oMain).trigger("end_session");$(s_oMain).trigger("share_event",l)};this.getPlayerX=function(){return D.getX()};this.update=function(){if(!1!==a){D.update();this._manageOpponentDepth();for(var b=0;b<p.length;b++)p[b].update();h||(R.update(),Q.update(),d+=s_iTimeElaps,!f&&d>r&&(d=0,this._spawnEnemy()),e&&(u+=s_iTimeElaps,
u>TIME_EFFECT_POWERUP?(e=!1,L.hidePowerUpGui(),D.setAcceleration(HERO_ACCELERATION,MAX_HERO_SPEED)):L.refreshPowerUpTime(u)))}};s_oGame=this;this._init()}var s_oGame=null;
function CInterface(a){var e,c,f,h,l,k,b,d,n,r,q,g,w,v,u,t,p,y,B,A,M,J,H,R,Q,L,G,I=null,D=null,O,N;this._init=function(a){if(s_bMobile){var C=s_oSpriteLibrary.getSprite("but_left");b=C.width/2+150;d=CANVAS_HEIGHT-C.height/2-20;Q=new CGfxButton(b,d,C,s_oStage);Q.addEventListener(ON_MOUSE_DOWN,this._onLeftDown,this);Q.addEventListener(ON_MOUSE_UP,this._onLeftUp,this);C=s_oSpriteLibrary.getSprite("but_right");l=CANVAS_WIDTH-C.width/2-150;k=CANVAS_HEIGHT-C.height/2-20;L=new CGfxButton(l,k,C,s_oStage);
L.addEventListener(ON_MOUSE_DOWN,this._onRightDown,this);L.addEventListener(ON_MOUSE_UP,this._onRightUp,this);C=s_oSpriteLibrary.getSprite("but_jump");f=CANVAS_WIDTH/2;h=CANVAS_HEIGHT-C.height/2-30;G=new CTextButton(f,h,C,TEXT_JUMP,FONT_GAME,"#fff",100,"center",0,s_oStage);G.addEventListener(ON_MOUSE_DOWN,this._onJumpDown,this);G.addEventListener(ON_MOUSE_UP,this._onJumpUp,this)}else document.onkeydown=s_oGame.onKeyDown,document.onkeyup=s_oGame.onKeyUp;C=s_oSpriteLibrary.getSprite("but_exit");e=CANVAS_WIDTH-
C.width/2-10;c=C.height/2+10;M=new CGfxButton(e,c,C,s_oStage);M.addEventListener(ON_MOUSE_UP,this._onExit,this);!1===DISABLE_SOUND_MOBILE||!1===s_bMobile?(u=e-C.width,t=c,C=s_oSpriteLibrary.getSprite("audio_icon"),H=new CToggle(u,t,C,s_bAudioActive,s_oStage),H.addEventListener(ON_MOUSE_UP,this._onAudioToggle,this),n=u-C.width/2,r=t):(n=e-C.width,r=c);C=window.document;var K=C.documentElement;I=K.requestFullscreen||K.mozRequestFullScreen||K.webkitRequestFullScreen||K.msRequestFullscreen;D=C.exitFullscreen||
C.mozCancelFullScreen||C.webkitExitFullscreen||C.msExitFullscreen;!1===ENABLE_FULLSCREEN&&(I=!1);I&&screenfull.enabled&&(C=s_oSpriteLibrary.getSprite("but_fullscreen"),R=new CToggle(n,r,C,s_bFullscreen,s_oStage),R.addEventListener(ON_MOUSE_UP,this._onFullscreenRelease,this));C=s_oSpriteLibrary.getSprite("but_settings");O=new CGUIExpandible(e,c,C,s_oStage);O.addButton(M);!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||O.addButton(H);I&&screenfull.enabled&&O.addButton(R);w=10;v=40;B=new createjs.Text(TEXT_SCORE,
"40px "+FONT_GAME,"#fff");B.x=w;B.y=v;B.textBaseline="alphabetic";B.textAlign="left";B.shadow=new createjs.Shadow("#000000",2,2,5);s_oStage.addChild(B);y=new createjs.Text(a,"40px "+FONT_GAME,"#fff");y.x=B.x+20;y.y=v;y.textBaseline="alphabetic";y.textAlign="left";y.shadow=new createjs.Shadow("#000000",2,2,5);s_oStage.addChild(y);q=CANVAS_WIDTH/2;g=40;A=new createjs.Text(TEXT_LEVEL+" "+s_iLevelSelected,"40px "+FONT_GAME,"#fff");A.x=q;A.y=g;A.textBaseline="alphabetic";A.textAlign="center";A.shadow=
new createjs.Shadow("#000000",2,2,5);s_oStage.addChild(A);J=new CPowerUpGui(s_oStage);N=new CAreYouSurePanel;N.addEventListener(ON_BUT_YES_DOWN,this._onExitYes,this);p=new CRollingScore;this.refreshButtonPos()};this.unload=function(){M.unload();M=null;O.unload();N.unload();!1===DISABLE_SOUND_MOBILE&&(H.unload(),H=null);I&&screenfull.enabled&&R.unload();s_bMobile?(Q.unload(),L.unload(),G.unload()):(document.onkeydown=null,document.onkeyup=null);s_oStage.removeAllChildren();s_oInterface=null};this.reset=
function(a,b){y.text=a;A.text=TEXT_LEVEL+" "+b;J.reset();s_bMobile||(document.onkeydown=s_oGame.onKeyDown,document.onkeyup=s_oGame.onKeyUp)};this.removeKeyListener=function(){document.onkeydown=null;document.onkeyup=null};this._initKeyListeners=function(){s_bMobile||(document.onkeydown=s_oGame.onKeyDown,document.onkeyup=s_oGame.onKeyUp)};this.refreshButtonPos=function(){B.x=w+s_iOffsetX;B.y=v+s_iOffsetY;y.x=B.x+B.getBounds().width+20;y.y=B.y;A.y=g+s_iOffsetY;O.refreshPos();s_bMobile&&(Q.setPosition(b+
s_iOffsetX,d-s_iOffsetY),L.setPosition(l-s_iOffsetX,k-s_iOffsetY),G.setPosition(f,h-s_iOffsetY));J.refreshButtonPos()};this.refreshScore=function(a){p.rolling(y,null,a)};this.refreshPowerUpTime=function(a){J.refreshTime(a)};this.showPowerUpGui=function(){J.show()};this.hidePowerUpGui=function(){J.hide()};this._onLeftDown=function(){s_oGame.moveLeft(!0)};this._onRightDown=function(){s_oGame.moveRight(!0)};this._onJumpDown=function(){s_oGame.moveJump(!0)};this._onLeftUp=function(){s_oGame.moveLeft(!1)};
this._onRightUp=function(){s_oGame.moveRight(!1)};this._onJumpUp=function(){s_oGame.moveJump(!1)};this._onExit=function(){N.show(TEXT_ARE_SURE)};this._onAudioToggle=function(){Howler.mute(s_bAudioActive);s_bAudioActive=!s_bAudioActive};this.resetFullscreenBut=function(){I&&screenfull.enabled&&R.setActive(s_bFullscreen)};this._onFullscreenRelease=function(){s_bFullscreen?D.call(window.document):I.call(window.document.documentElement);sizeHandler()};this._onExitYes=function(){s_oGame.onExit()};s_oInterface=
this;this._init(a);return this}var s_oInterface=null;
function CHelpPanel(){var a,e,c,f,h,l,k,b,d,n,r=this;this._init=function(){n=new createjs.Container;n.visible=!1;s_oStage.addChild(n);c=new createjs.Shape;c.graphics.beginFill("rgba(0,0,0,0.7)").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);e=c.on("click",function(){});n.addChild(c);var a=s_oSpriteLibrary.getSprite("msg_box_wide"),g=createBitmap(a);g.regX=a.width/2;g.regY=a.height/2;g.x=CANVAS_WIDTH/2;g.y=CANVAS_HEIGHT/2;n.addChild(g);if(s_bMobile){a=s_oSpriteLibrary.getSprite("but_left");g=s_oSpriteLibrary.getSprite("but_right");
var r=s_oSpriteLibrary.getSprite("but_jump");l=new CTextButton(CANVAS_WIDTH/2+240,CANVAS_HEIGHT/2+130,r,TEXT_JUMP,FONT_GAME,"#fff",100,"center",0,n);l.setScale(.65)}else a=s_oSpriteLibrary.getSprite("key_0"),g=s_oSpriteLibrary.getSprite("key_1"),r=s_oSpriteLibrary.getSprite("key_2"),l=createBitmap(r),l.regX=r.width/2,l.regY=r.height/2,l.x=CANVAS_WIDTH/2+240,l.y=CANVAS_HEIGHT/2+130,n.addChild(l);f=createBitmap(a);f.regX=a.width/2;f.regY=a.height/2;f.x=CANVAS_WIDTH/2-310;f.y=CANVAS_HEIGHT/2+130;n.addChild(f);
h=createBitmap(g);h.regX=g.width/2;h.regY=g.height/2;h.x=CANVAS_WIDTH/2-190;h.y=CANVAS_HEIGHT/2+130;n.addChild(h);b=this._attachPlayerRun();b.gotoAndPlay("anim");d=this._attachPlayerJump();d.on("animationend",this._onEndJump,this);k=new CGfxButton(CANVAS_WIDTH/2,CANVAS_HEIGHT/2,s_oSpriteLibrary.getSprite("but_next"),n);k.addEventListener(ON_MOUSE_UP,this._onStart,this);this._playAnims()};this.unload=function(){c.off("click",e)};this.show=function(){n.alpha=0;n.visible=!0;createjs.Tween.get(n).to({alpha:1},
500)};this.hide=function(){createjs.Tween.get(n).to({alpha:0},500,createjs.Ease.cubicOut).call(function(){clearInterval(a);n.visible=!1})};this._attachPlayerRun=function(){var a={images:[s_oSpriteLibrary.getSprite("player"+s_iTeamSelected+"_run_0"),s_oSpriteLibrary.getSprite("player"+s_iTeamSelected+"_run_1")],frames:[[1,1,609,448,0,0,0],[612,1,609,448,0,0,0],[1223,1,609,448,0,0,0],[1,451,609,448,0,0,0],[612,451,609,448,0,0,0],[1223,451,609,448,0,0,0],[1,901,609,448,0,0,0],[612,901,609,448,0,0,0],
[1223,901,609,448,0,0,0],[1,1351,609,448,0,0,0],[612,1351,609,448,0,0,0],[1223,1351,609,448,0,0,0],[1,1,609,448,1,0,0],[612,1,609,448,1,0,0],[1223,1,609,448,1,0,0],[1,451,609,448,1,0,0],[612,451,609,448,1,0,0],[1223,451,609,448,1,0,0]],animations:{start:0,anim:[0,17]}};a=new createjs.SpriteSheet(a);a=new createjs.Sprite(a,"start");a.scaleX=a.scaleY=.4;a.x=CANVAS_WIDTH/2-320;a.y=CANVAS_HEIGHT/2+70;a.regX=304.5;a.regY=448;n.addChild(a);return a};this._attachPlayerJump=function(a,b){var d={images:[s_oSpriteLibrary.getSprite("player"+
s_iTeamSelected+"_jump_0"),s_oSpriteLibrary.getSprite("player"+s_iTeamSelected+"_jump_1"),s_oSpriteLibrary.getSprite("player"+s_iTeamSelected+"_jump_2"),s_oSpriteLibrary.getSprite("player"+s_iTeamSelected+"_jump_3"),s_oSpriteLibrary.getSprite("player"+s_iTeamSelected+"_jump_4"),s_oSpriteLibrary.getSprite("player"+s_iTeamSelected+"_jump_5"),s_oSpriteLibrary.getSprite("player"+s_iTeamSelected+"_jump_6")],frames:[[1,1,993,712,0,0,0],[996,1,993,712,0,0,0],[1,715,993,712,0,0,0],[996,715,993,712,0,0,0],
[1,1,993,712,1,0,0],[996,1,993,712,1,0,0],[1,715,993,712,1,0,0],[996,715,993,712,1,0,0],[1,1,993,712,2,0,0],[996,1,993,712,2,0,0],[1,715,993,712,2,0,0],[996,715,993,712,2,0,0],[1,1,993,712,3,0,0],[996,1,993,712,3,0,0],[1,715,993,712,3,0,0],[996,715,993,712,3,0,0],[1,1,993,712,4,0,0],[996,1,993,712,4,0,0],[1,715,993,712,4,0,0],[996,715,993,712,4,0,0],[1,1,993,712,5,0,0],[996,1,993,712,5,0,0],[1,715,993,712,5,0,0],[996,715,993,712,5,0,0],[1,1,993,712,6,0,0],[996,1,993,712,6,0,0]],animations:{start:0,
anim:[0,25,"stop_anim"],stop_anim:25}};d=new createjs.SpriteSheet(d);d=new createjs.Sprite(d,"start");d.scaleX=d.scaleY=.4;d.x=CANVAS_WIDTH/2+180;d.y=CANVAS_HEIGHT/2-35;d.regX=304.5;d.regY=448;n.addChild(d);return d};this._playAnims=function(){var c=b.x+130,e=b.x;h.scaleX=h.scaleY=.9;createjs.Tween.get(b,{loop:!0}).to({x:c},2E3,createjs.Ease.cubicOut).call(function(){h.scaleX=h.scaleY=1;f.scaleX=f.scaleY=.9}).to({x:e},2E3,createjs.Ease.cubicOut).call(function(){f.scaleX=f.scaleY=1;h.scaleX=h.scaleY=
.9});a=setInterval(function(){s_bMobile?l.setScale(.6):l.scaleX=l.scaleY=.9;d.gotoAndPlay("anim")},3E3)};this._onEndJump=function(a){"anim"===a.currentTarget.currentAnimation&&(s_bMobile?l.setScale(.65):l.scaleX=l.scaleY=1)};this._onStart=function(){s_oInterface.removeKeyListener();k.disable();r.hide();s_oGame.startCountdown()};this.isVisible=function(){return n.visible};this._init()}
function CLevelSettings(){var a,e,c,f;this._init=function(){a=[16,18,20,22,24,26,28,30,32,34,36];e=[1500,1400,1300,1400,1300,1300,1200,1100,1600,1500,1400];c=[1,1,1,2,2,2,2,2,3,3,3];f=[[4],[4],[5],[6],[7],[8],[9],[10],[11],[12],[4,9]];NUM_LEVELS=a.length};this.getEnemiesSpawn=function(c){return a[c-1]};this.getStartingEnemySpawn=function(a){return e[a-1]};this.getEnemySpawnNumber=function(a){return c[a-1]};this.getPowerUps=function(a){return f[a-1]};this._init()}
function CLevelMenu(){var a,e,c,f,h,l,k,b,d,n,r,q,g,w,v,u,t,p=null,y=null;this._init=function(){k=0;u=new createjs.Container;s_oStage.addChild(u);var n=createBitmap(s_oSpriteLibrary.getSprite("bg_menu_level"));u.addChild(n);q=new createjs.Shape;q.graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);q.alpha=.5;u.addChild(q);g=new createjs.Container;g.x=CANVAS_WIDTH/2+90;u.addChild(g);new CTLText(g,0,0,600,46,80,"center","#ffffff",FONT_GAME,1,20,2,TEXT_SELECT_LEVEL,!0,!0,!0,!1);n=s_oSpriteLibrary.getSprite("but_exit");
h=CANVAS_WIDTH-n.width/2-10;l=n.height/2+10;w=new CGfxButton(h,l,n,s_oStage);w.addEventListener(ON_MOUSE_UP,this._onExit,this);d=[];n=[{x:0,y:150},{x:200,y:150},{x:400,y:150},{x:600,y:150},{x:0,y:350},{x:200,y:350},{x:400,y:350},{x:600,y:350},{x:100,y:550},{x:300,y:550},{x:500,y:550}];for(var A=0;A<NUM_LEVELS;A++){var M=new CLevelBut(n[A].x,n[A].y,s_aTeamSeq[A],A+1,getLevelScore(A+1),A+1>s_iLastLevel?!1:!0,g);M.addEventListenerWithParams(ON_MOUSE_UP,this._onButLevelRelease,this,A);d.push(M)}g.regX=
g.getBounds().width/2;g.regY=g.getBounds().height/2;b=-g.getBounds().height/2;if(!1===DISABLE_SOUND_MOBILE||!1===s_bMobile)n=s_oSpriteLibrary.getSprite("audio_icon"),c=h-n.width/2-10,f=l,v=new CToggle(c,f,n,s_bAudioActive,s_oStage),v.addEventListener(ON_MOUSE_UP,this._onAudioToggle,this);n=window.document;A=n.documentElement;p=A.requestFullscreen||A.mozRequestFullScreen||A.webkitRequestFullScreen||A.msRequestFullscreen;y=n.exitFullscreen||n.mozCancelFullScreen||n.webkitExitFullscreen||n.msExitFullscreen;
!1===ENABLE_FULLSCREEN&&(p=!1);p&&screenfull.enabled&&(n=s_oSpriteLibrary.getSprite("but_fullscreen"),a=n.width/4+10,e=n.height/2+10,t=new CToggle(a,e,n,s_bFullscreen,s_oStage),t.addEventListener(ON_MOUSE_UP,this._onFullscreenRelease,this));r=new CLoaderResourcesPanel(s_oStage);r.addEventListener(ON_END_LOADING,this._onEndLoading,this);this.refreshButtonPos();q.alpha=0;g.y=b;u.visible=!0;createjs.Tween.get(q).to({alpha:.7},500);createjs.Tween.get(g).to({y:CANVAS_HEIGHT/2},500,createjs.Ease.cubicOut)};
this.unload=function(){for(var a=0;a<d.length;a++)d[a].unload();!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||v.unload();p&&screenfull.enabled&&t.unload();w.unload();r.unload();s_oStage.removeAllChildren();s_oLevelMenu=null};this.refreshButtonPos=function(){w.setPosition(h-s_iOffsetX,l+s_iOffsetY);!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||v.setPosition(c-s_iOffsetX,s_iOffsetY+f);p&&screenfull.enabled&&t.setPosition(a+s_iOffsetX,e+s_iOffsetY)};this._onRight=function(){k++;k>=(void 0).length&&(k=0)};
this._onLeft=function(){k--;0>k&&(k=(void 0).length-1)};this._onButLevelRelease=function(a){n=s_aTeamSeq[a];s_oMain.levelSelected(a+1);if(s_aTeamLoaded[n])s_oLevelMenu.unload(),s_oMain.gotoGame();else{a=[];for(var b=0;18>b;b++)a.push({name:"player"+n+"_run_ahead_"+b,path:"./sprites/player_"+n+"/enemy/running/player"+n+"_run_ahead_"+b+".png"});for(b=0;18>b;b++)a.push({name:"player"+n+"_tackle_"+b,path:"./sprites/player_"+n+"/enemy/tackle/player"+n+"_tackle_"+b+".png"});r.start(a)}};this._onEndLoading=
function(){s_aTeamLoaded[n]=!0;s_oLevelMenu.unload();s_oMain.gotoGame()};this._onAudioToggle=function(){Howler.mute(s_bAudioActive);s_bAudioActive=!s_bAudioActive};this.resetFullscreenBut=function(){p&&screenfull.enabled&&t.setActive(s_bFullscreen)};this._onFullscreenRelease=function(){s_bFullscreen?y.call(window.document):p.call(window.document.documentElement);sizeHandler()};this._onExit=function(){s_oLevelMenu.unload();s_oMain.gotoMenu()};s_oLevelMenu=this;this._init()}var s_oLevelMenu=null;
function CLevelBut(a,e,c,f,h,l,k){var b,d,n,r=[],q=[],g,w,v,u,t;this._init=function(a,c,e,f,h,k){d=[];n=[];t=new createjs.Container;t.x=a;t.y=c;p.addChild(t);a=s_oSpriteLibrary.getSprite("but_level");c={images:[a],frames:{width:a.width/2,height:a.height,regX:a.width/2/2,regY:a.height/2},animations:{state_true:[0],state_false:[1]}};c=new createjs.SpriteSheet(c);b=k;u=createSprite(c,"state_"+b,a.width/2/2,a.height/2,a.width/2,a.height);s_bMobile||(t.cursor="pointer");t.addChild(u);r.push(u);k="#fff";
!1===b&&(k="#cacaca");w=new CTLText(t,-80,-80,160,30,30,"center","#00397a",FONT_GAME,1,0,0,TEXT_LEVEL+" "+f,!0,!0,!0,!1);w.setOutline(4);new CTLText(t,-80,-80,160,30,30,"center",k,FONT_GAME,1,0,0,TEXT_LEVEL+" "+f,!0,!0,!0,!1);c={images:[s_oSpriteLibrary.getSprite("but_flag_"+e)],frames:{width:124,height:98,regX:62,regY:49},animations:{state_true:[0],state_false:[1]}};c=new createjs.SpriteSheet(c);g=createSprite(c,"state_"+b,62,62,124,98);g.y=4;t.addChild(g);0<h&&(v=new CTLText(t,-84,64,168,20,20,
"center","#00397a",FONT_GAME,1,0,0,TEXT_SCORE+" "+h,!0,!0,!0,!1),v.setOutline(4),new CTLText(t,-84,64,168,20,20,"center",k,FONT_GAME,1,0,0,TEXT_SCORE+" "+h,!0,!0,!0,!1));this._initListener()};this.unload=function(){t.off("mousedown",this.buttonDown);t.off("pressup",this.buttonRelease);t.removeChild(u)};this._initListener=function(){t.on("mousedown",this.buttonDown);t.on("pressup",this.buttonRelease)};this.viewBut=function(a){t.addChild(a)};this.addEventListener=function(a,b,c){d[a]=b;n[a]=c};this.addEventListenerWithParams=
function(a,b,c,e){d[a]=b;n[a]=c;q=e};this.ifClickable=function(){return!0===t.mouseEnabled?1:0};this.setActive=function(a,d){b=d;r[a].gotoAndStop("state_"+b);r[a].mouseEnabled=!0};this.buttonRelease=function(){b&&(playSound("click",1,!1),d[ON_MOUSE_UP]&&d[ON_MOUSE_UP].call(n[ON_MOUSE_UP],q))};this.buttonDown=function(){d[ON_MOUSE_DOWN]&&d[ON_MOUSE_DOWN].call(n[ON_MOUSE_DOWN],q)};this.setPosition=function(a,b){t.x=a;t.y=b};this.setVisible=function(a){t.visible=a};var p=k;this._init(a,e,c,f,h,l,k)}
function CCreditsPanel(){var a,e,c,f,h,l,k,b;this._init=function(){b=new createjs.Container;s_oStage.addChild(b);var d=new createjs.Shape;d.graphics.beginFill("rgba(0,0,0,0.7)").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);b.addChild(d);d=s_oSpriteLibrary.getSprite("msg_box");e=createBitmap(d);e.regX=d.width/2;e.regY=d.height/2;e.x=CANVAS_WIDTH/2;e.y=CANVAS_HEIGHT/2;b.addChild(e);l=new createjs.Shape;l.graphics.beginFill("#0f0f0f").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);l.alpha=.01;a=l.on("click",this._onLogoButRelease);
b.addChild(l);d=s_oSpriteLibrary.getSprite("but_exit");f=new CGfxButton(980,240,d,b);f.addEventListener(ON_MOUSE_UP,this.unload,this);h=new createjs.Text(TEXT_CREDITS_DEVELOPED,"26px "+FONT_GAME,"#fff");h.textAlign="center";h.textBaseline="alphabetic";h.x=CANVAS_WIDTH/2;h.y=330;b.addChild(h);d=s_oSpriteLibrary.getSprite("logo_ctl");c=createBitmap(d);c.regX=d.width/2;c.regY=d.height/2;c.x=CANVAS_WIDTH/2;c.y=CANVAS_HEIGHT/2;b.addChild(c);k=new createjs.Text("www.codethislab.com","26px "+FONT_GAME,"#fff");
k.textAlign="center";k.textBaseline="alphabetic";k.x=CANVAS_WIDTH/2;k.y=450;b.addChild(k)};this.unload=function(){l.off("click",a);f.unload();f=null;s_oStage.removeChild(b)};this._onLogoButRelease=function(){window.open("http://www.codethislab.com/index.php?&l=en","_blank")};this._init()}
function CAlertSavingBox(a,e){var c,f;this._init=function(a){f=new createjs.Container;l.addChild(f);var b=new createjs.Shape;b.graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);b.alpha=.5;b.on("click",function(){});f.addChild(b);b=s_oSpriteLibrary.getSprite("msg_box");var d=createBitmap(b);d.x=.5*CANVAS_WIDTH;d.y=.5*CANVAS_HEIGHT;d.regX=.5*b.width;d.regY=.5*b.height;f.addChild(d);new CTLText(f,CANVAS_WIDTH/2-b.width/2,CANVAS_HEIGHT/2-140,b.width,190,40,"center","#ffffff",FONT_GAME,
1,20,10,a,!0,!0,!0,!1);c=new CGfxButton(CANVAS_WIDTH/2,475,s_oSpriteLibrary.getSprite("but_exit"),f);c.addEventListener(ON_MOUSE_UP,this._onButOk,this)};this._onButOk=function(){h.unload()};this.unload=function(){c.unload();l.removeChild(f)};var h=this;var l=e;this._init(a)}
function CAreYouSurePanel(){var a,e,c,f,h,l,k,b,d=this;this._init=function(){a=[];e=[];k=new createjs.Container;k.visible=!1;s_oStage.addChild(k);b=new createjs.Shape;b.graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);b.alpha=.5;b.on("click",function(){});k.addChild(b);var d=s_oSpriteLibrary.getSprite("msg_box");c=createBitmap(d);c.x=CANVAS_WIDTH/2;c.y=CANVAS_HEIGHT/2;c.regX=.5*d.width;c.regY=.5*d.height;k.addChild(c);f=new CTLText(k,CANVAS_WIDTH/2-d.width/2,CANVAS_HEIGHT/2-d.height/
2,d.width,150,70,"center","#ffffff",FONT_GAME,1,40,10,TEXT_ARE_SURE,!0,!0,!0,!1);h=new CGfxButton(CANVAS_WIDTH/2+150,.5*CANVAS_HEIGHT+70,s_oSpriteLibrary.getSprite("but_yes"),k);h.addEventListener(ON_MOUSE_UP,this._onButYes,this);l=new CGfxButton(CANVAS_WIDTH/2-150,.5*CANVAS_HEIGHT+70,s_oSpriteLibrary.getSprite("but_no"),k);l.addEventListener(ON_MOUSE_UP,this._onButNo,this)};this.addEventListener=function(b,d,c){a[b]=d;e[b]=c};this.show=function(a){f.refreshText(a);k.alpha=0;k.visible=!0;createjs.Tween.get(k).to({alpha:1},
300,createjs.Ease.quartOut).call(function(){s_oMain.stopUpdateNoBlock()})};this.hide=function(){s_oMain.startUpdateNoBlock();createjs.Tween.get(k).to({alpha:0},500,createjs.Ease.quartOut).call(function(){k.visible=!1})};this.unload=function(){l.unload();h.unload()};this._onButYes=function(){d.hide();a[ON_BUT_YES_DOWN]&&a[ON_BUT_YES_DOWN].call(e[ON_BUT_YES_DOWN])};this._onButNo=function(){d.hide()};this._init()}
function CGUIExpandible(a,e,c,f){var h,l,k,b,d,n,r,q;this._init=function(a,c,e,g){b=[];n=new createjs.Container;n.x=a;n.y=c;g.addChild(n);r=new createjs.Container;n.addChild(r);q=new createjs.Container;n.addChild(q);k=!1;d=new CGfxButton(0,0,e,q);d.addEventListener(ON_MOUSE_UP,this._onMenu,this);l=h=85};this.unload=function(){d.unload();f.removeChild(n)};this.refreshPos=function(){n.x=a-s_iOffsetX;n.y=e+s_iOffsetY};this.addButton=function(a){a=a.getButtonImage();a.x=0;a.y=0;a.visible=0;r.addChildAt(a,
0);b.push(a)};this._onMenu=function(){(k=!k)?g._expand():g._collapse()};this._expand=function(){for(var a=0;a<b.length;a++)b[a].visible=!0,createjs.Tween.get(b[a],{override:!0}).wait(300*a/2).to({y:h+a*l},300,createjs.Ease.cubicOut)};this._collapse=function(){for(var a=0;a<b.length;a++){var d=b[b.length-1-a];createjs.Tween.get(d,{override:!0}).wait(300*a/2).to({y:0},300,createjs.Ease.cubicOut).call(function(a){a.visible=!1},[d])}};var g=this;this._init(a,e,c,f)}
function CField(a,e,c){var f=!1,h,l,k,b;this._init=function(a,c){b=new createjs.Container;b.visible=!1;b.x=a;b.y=c;d.addChild(b);k=[];for(var e=0;18>e;e++){var g=createBitmap(s_oSpriteLibrary.getSprite("field_loop_"+e));b.addChild(g);k.push(g);0<e&&(g.visible=!1)}};this.show=function(){h=k.length;k[0].visible=!0;l=0;f=b.visible=!0};this.hide=function(){b.visible=!1};this.playToFrame=function(a){k[l].visible=!1;l=a;k[l].visible=!0};this.nextFrame=function(){k[l].visible=!1;l++;k[l].visible=!0};this.update=
function(){!1!==f&&(l===h-1?this.playToFrame(0):this.nextFrame())};var d=c;this._init(a,e)}
function CFieldEndZone(a,e,c){var f=!1,h,l,k,b;this._init=function(a,c){b=new createjs.Container;b.visible=!1;b.x=a;b.y=c;d.addChild(b);k=[];for(var e=0;39>e;e++){var g=createBitmap(s_oSpriteLibrary.getSprite("end_zone_"+e));b.addChild(g);k.push(g);0<e&&(g.visible=!1)}};this.show=function(){h=k.length;k[0].visible=!0;l=0;f=b.visible=!0};this.hide=function(){b.visible=!1};this.reset=function(){for(var a=0;a<k.length;a++)k[a].visible=!1;b.visible=!1};this.playToFrame=function(a){k[l].visible=!1;l=a;
k[l].visible=!0};this.nextFrame=function(){k[l].visible=!1;l++;k[l].visible=!0};this.update=function(){!1!==f&&(l===h-1?(f=!1,s_oGame.endZonePlayed()):this.nextFrame())};var d=c;this._init(a,e)}
function CPlayer(a,e,c){var f=!1,h,l=!1,k=!1,b,d,n,r,q,g,w,v,u,t,p,y,B=this,A;this._init=function(a,c){h=!1;d=a;n=c;g=0;r=HERO_ACCELERATION;q=MAX_HERO_SPEED;p=[];y=[];A=new createjs.Container;A.x=a;A.y=c;M.addChild(A);u=[];t=[];t[PLAYER_ANIM_RUN]=18;t[PLAYER_ANIM_FALL]=9;t[PLAYER_ANIM_TOUCHDOWN]=50;t[PLAYER_ANIM_JUMP]=26;var e={images:[s_oSpriteLibrary.getSprite("player"+s_iTeamSelected+"_run_0"),s_oSpriteLibrary.getSprite("player"+s_iTeamSelected+"_run_1")],frames:[[1,1,609,448,0,0,0],[612,1,609,
448,0,0,0],[1223,1,609,448,0,0,0],[1,451,609,448,0,0,0],[612,451,609,448,0,0,0],[1223,451,609,448,0,0,0],[1,901,609,448,0,0,0],[612,901,609,448,0,0,0],[1223,901,609,448,0,0,0],[1,1351,609,448,0,0,0],[612,1351,609,448,0,0,0],[1223,1351,609,448,0,0,0],[1,1,609,448,1,0,0],[612,1,609,448,1,0,0],[1223,1,609,448,1,0,0],[1,451,609,448,1,0,0],[612,451,609,448,1,0,0],[1223,451,609,448,1,0,0]],animations:{start:0,anim:[0,t[PLAYER_ANIM_RUN]-1]}};e=new createjs.SpriteSheet(e);u[PLAYER_ANIM_RUN]=new createjs.Sprite(e,
"start");u[PLAYER_ANIM_RUN].regX=304.5;u[PLAYER_ANIM_RUN].regY=448;A.addChild(u[PLAYER_ANIM_RUN]);e={images:[s_oSpriteLibrary.getSprite("player"+s_iTeamSelected+"_falling")],frames:{width:611,height:450},animations:{start:0,anim:[0,t[PLAYER_ANIM_FALL]-1,"stop_anim"],stop_anim:t[PLAYER_ANIM_FALL]}};e=new createjs.SpriteSheet(e);u[PLAYER_ANIM_FALL]=new createjs.Sprite(e,"start");u[PLAYER_ANIM_FALL].on("animationend",this._onPlayerFall,this);u[PLAYER_ANIM_FALL].visible=!1;u[PLAYER_ANIM_FALL].regX=304.5;
u[PLAYER_ANIM_FALL].regY=448;A.addChild(u[PLAYER_ANIM_FALL]);e={images:[s_oSpriteLibrary.getSprite("player"+s_iTeamSelected+"_touchdown_0"),s_oSpriteLibrary.getSprite("player"+s_iTeamSelected+"_touchdown_1"),s_oSpriteLibrary.getSprite("player"+s_iTeamSelected+"_touchdown_2"),s_oSpriteLibrary.getSprite("player"+s_iTeamSelected+"_touchdown_3"),s_oSpriteLibrary.getSprite("player"+s_iTeamSelected+"_touchdown_4"),s_oSpriteLibrary.getSprite("player"+s_iTeamSelected+"_touchdown_5")],frames:{width:611,height:450},
animations:{start:0,anim:[0,t[PLAYER_ANIM_TOUCHDOWN]-1,"stop_anim"],stop_anim:t[PLAYER_ANIM_TOUCHDOWN]-1}};e=new createjs.SpriteSheet(e);u[PLAYER_ANIM_TOUCHDOWN]=new createjs.Sprite(e,"start");u[PLAYER_ANIM_TOUCHDOWN].on("animationend",this._onPlayerTouchdown,this);u[PLAYER_ANIM_TOUCHDOWN].visible=!1;u[PLAYER_ANIM_TOUCHDOWN].regX=304.5;u[PLAYER_ANIM_TOUCHDOWN].regY=448;A.addChild(u[PLAYER_ANIM_TOUCHDOWN]);e={images:[s_oSpriteLibrary.getSprite("player"+s_iTeamSelected+"_jump_0"),s_oSpriteLibrary.getSprite("player"+
s_iTeamSelected+"_jump_1"),s_oSpriteLibrary.getSprite("player"+s_iTeamSelected+"_jump_2"),s_oSpriteLibrary.getSprite("player"+s_iTeamSelected+"_jump_3"),s_oSpriteLibrary.getSprite("player"+s_iTeamSelected+"_jump_4"),s_oSpriteLibrary.getSprite("player"+s_iTeamSelected+"_jump_5"),s_oSpriteLibrary.getSprite("player"+s_iTeamSelected+"_jump_6")],frames:[[1,1,993,712,0,0,0],[996,1,993,712,0,0,0],[1,715,993,712,0,0,0],[996,715,993,712,0,0,0],[1,1,993,712,1,0,0],[996,1,993,712,1,0,0],[1,715,993,712,1,0,0],
[996,715,993,712,1,0,0],[1,1,993,712,2,0,0],[996,1,993,712,2,0,0],[1,715,993,712,2,0,0],[996,715,993,712,2,0,0],[1,1,993,712,3,0,0],[996,1,993,712,3,0,0],[1,715,993,712,3,0,0],[996,715,993,712,3,0,0],[1,1,993,712,4,0,0],[996,1,993,712,4,0,0],[1,715,993,712,4,0,0],[996,715,993,712,4,0,0],[1,1,993,712,5,0,0],[996,1,993,712,5,0,0],[1,715,993,712,5,0,0],[996,715,993,712,5,0,0],[1,1,993,712,6,0,0],[996,1,993,712,6,0,0]],animations:{start:0,anim:[0,t[PLAYER_ANIM_JUMP]-1,"stop_anim"],stop_anim:t[PLAYER_ANIM_JUMP]}};
e=new createjs.SpriteSheet(e);u[PLAYER_ANIM_JUMP]=new createjs.Sprite(e,"start");u[PLAYER_ANIM_JUMP].on("animationend",this._onPlayerJump);u[PLAYER_ANIM_JUMP].visible=!1;u[PLAYER_ANIM_JUMP].x=-200;u[PLAYER_ANIM_JUMP].y=-220;u[PLAYER_ANIM_JUMP].regX=304.5;u[PLAYER_ANIM_JUMP].regY=448;A.addChild(u[PLAYER_ANIM_JUMP]);b=PLAYER_ANIM_RUN};this.addEventListener=function(a,b,d){p[a]=b;y[a]=d};this.show=function(){u[b].visible=!0;u[b].gotoAndPlay("anim");A.visible=!0;w=A.getBounds().width-300;v=A.getBounds().height;
f=!0};this.hide=function(){f=!1;A.visible=!1};this.reset=function(){k=l=h=f=!1;g=0;r=HERO_ACCELERATION;q=MAX_HERO_SPEED;A.alpha=1;A.x=d;A.y=n;u[PLAYER_ANIM_RUN].visible=!1;u[PLAYER_ANIM_FALL].visible=!1;u[PLAYER_ANIM_TOUCHDOWN].visible=!1;u[PLAYER_ANIM_JUMP].visible=!1;b=PLAYER_ANIM_RUN};this.changeAnim=function(a){-1!==b&&(u[b].visible=!1,u[b].gotoAndStop("start"),b=a,u[b].visible=!0,u[b].gotoAndPlay("anim"))};this.jump=function(){h=!0;this.changeAnim(PLAYER_ANIM_JUMP)};this.moveLeft=function(a){l=
a};this.moveRight=function(a){k=a};this.setAcceleration=function(a,b){r=a;q=b};this.setY=function(a){A.y=a};this._onPlayerFall=function(a){"anim"===a.currentTarget.currentAnimation&&(B.hide(),p[ON_PLAYER_TACKLED]&&p[ON_PLAYER_TACKLED].call(y[ON_PLAYER_TACKLED]))};this._onPlayerTouchdown=function(a){"anim"===a.currentTarget.currentAnimation&&((new createjs.Tween.get(A)).to({alpha:0},500),p[ON_PLAYER_TOUCHDOWN]&&p[ON_PLAYER_TOUCHDOWN].call(y[ON_PLAYER_TOUCHDOWN]),b=-1)};this._onPlayerJump=function(a){"anim"===
a.currentTarget.currentAnimation&&(h=!1,B.changeAnim(PLAYER_ANIM_RUN))};this.getRect=function(){return new createjs.Rectangle(A.x-w/2,A.y-v,w,v)};this.isJumping=function(){return h};this.getCurAnim=function(){return b};this.getX=function(){return A.x};this._updateMove=function(){b===PLAYER_ANIM_RUN&&(l&&(g-=r),k&&(g+=r),A.x+=g,g*=HERO_FRICTION,g>q&&(g=q),g<-q&&(g=-q),.1>Math.abs(g)&&(g=0),A.x+g>CANVAS_WIDTH-s_iOffsetX&&(A.x=CANVAS_WIDTH-g-s_iOffsetX),A.x-g<s_iOffsetX&&(A.x=g+s_iOffsetX))};this.update=
function(){!1!==f&&this._updateMove()};var M=c;this._init(a,e)}
function COpponent(a,e,c,f,h){var l,k,b=!1,d,n,r,q,g,w,v,u,t,p,y,B=this;this._init=function(a,b,c){t=[];p=[];l=b;k=c;y=new createjs.Container;y.x=b;y.y=c;y.scaleX=y.scaleY=.1;A.addChild(y);u=[];u[PLAYER_ANIM_RUN]=18;u[PLAYER_ANIM_FALL]=18;v=[];v[PLAYER_ANIM_RUN]=[];for(b=0;b<u[PLAYER_ANIM_RUN];b++){c=s_oSpriteLibrary.getSprite("player"+a+"_run_ahead_"+b);var e=createBitmap(c);e.visible=!1;e.regX=c.width/2;e.regY=c.height;y.addChild(e);v[PLAYER_ANIM_RUN].push(e);g=c.width-500;w=c.height}v[PLAYER_ANIM_FALL]=
[];for(b=0;b<u[PLAYER_ANIM_FALL];b++)c=s_oSpriteLibrary.getSprite("player"+a+"_tackle_"+b),e=createBitmap(c),e.visible=!1,e.regX=c.width/2,e.regY=c.height,y.addChild(e),v[PLAYER_ANIM_FALL].push(e);d=PLAYER_ANIM_RUN;this.show()};this.addEventListener=function(a,b,d){t[a]=b;p[a]=d};this.reset=function(){y.x=l;y.y=k;y.scaleX=y.scaleY=.1;for(var a=0;a<u[PLAYER_ANIM_RUN];a++)v[PLAYER_ANIM_RUN][a].visible=!1;for(a=0;a<u[PLAYER_ANIM_FALL];a++)v[PLAYER_ANIM_FALL][a].visible=!1;d=PLAYER_ANIM_RUN};this.show=
function(){b=!1;n=1;this.reset();B._startRun()};this._startRun=function(){r=u[d];v[d][0].visible=!0;q=Math.floor(Math.random()*v[PLAYER_ANIM_RUN].length);y.alpha=0;y.visible=!0;(new createjs.Tween.get(y)).to({alpha:1},500);(new createjs.Tween.get(y)).to({scaleX:1,scaleY:1,y:OPPONENT_FINAL_Y},TIME_OPPONENT_RUN,createjs.Ease.cubicIn).call(function(){if(t[ON_OPPONENT_TACKLE]){var a=new createjs.Rectangle(y.x-g/2,y.y-w,g,w);t[ON_OPPONENT_TACKLE].call(p[ON_OPPONENT_TACKLE],a)}});(new createjs.Tween.get(y)).wait(2500).call(function(){s_oGame.getPlayerX()>
y.x&&(n=-1);B._changeAnim(PLAYER_ANIM_FALL,Math.floor(4*Math.random()));playSound("enemy",1,!1)});setTimeout(function(){},2500);b=!0};this.hide=function(){b=!1;y.visible=!1;t[ON_OPPONENT_HIDE]&&t[ON_OPPONENT_HIDE].call(p[ON_OPPONENT_HIDE],a)};this.playToFrame=function(a){v[d][q].visible=!1;q=a;v[d][q].scaleX=n;v[d][q].visible=!0};this.nextFrame=function(){v[d][q].visible=!1;q++;v[d][q].scaleX=n;v[d][q].visible=!0};this._changeAnim=function(a,c){b=!1;v[d][q].visible=!1;d=a;q=c;v[d][q].visible=!0;r=
u[d];b=!0};this.update=function(){!1!==b&&(q===r-1?d===PLAYER_ANIM_RUN?this.playToFrame(0):this.hide():this.nextFrame())};var A=h;this._init(e,c,f)}
function CEndPanel(){var a,e,c,f,h,l,k,b,d,n,r,q,g,w=this;this._init=function(){a=!1;f=[];h=[];q=new createjs.Container;q.visible=!1;s_oStage.addChild(q);k=new createjs.Shape;k.graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);k.alpha=0;l=k.on("click",function(){});q.addChild(k);g=new createjs.Container;g.x=CANVAS_WIDTH/2;q.addChild(g);var c=s_oSpriteLibrary.getSprite("msg_box_wide"),u=createBitmap(c);g.addChild(u);b=new CTLText(g,0,0,c.width,120,80,"center","#ffffff",FONT_GAME,
1,40,10,"",!0,!0,!0,!1);d=new CTLText(g,0,c.height/2-60,c.width,80,80,"center","#ffffff",FONT_GAME,1,40,10,"",!0,!0,!0,!1);n=new CGfxButton(c.width/2-250,c.height/2+120,s_oSpriteLibrary.getSprite("but_home"),g);n.addEventListener(ON_MOUSE_UP,this._onHome,this);r=new CGfxButton(c.width/2+250,c.height/2+120,s_oSpriteLibrary.getSprite("but_restart"),g);r.addEventListener(ON_MOUSE_UP,this._onRestart,this);e=-c.height/2;g.regX=c.width/2;g.regY=c.height/2};this.unload=function(){n.unload();r.unload();k.off("click",
l)};this.addEventListener=function(a,b,d){f[a]=b;h[a]=d};this.show=function(c,f){setVolume("soundtrack",0);(f===TEXT_CONGRATS?playSound("level_win",1,!1):playSound("game_over",1,!1)).on("end",function(){setVolume("soundtrack",1)});b.refreshText(f);d.refreshText(TEXT_SCORE+": "+c);k.alpha=0;g.y=e;q.visible=!0;createjs.Tween.get(k).to({alpha:.7},500);createjs.Tween.get(g).wait(400).to({y:CANVAS_HEIGHT/2},1E3,createjs.Ease.bounceOut).call(function(){w.enableButtons();a=!0})};this.hide=function(){createjs.Tween.get(g).to({y:e},
1E3,createjs.Ease.backIn).call(function(){a=!1;q.visible=!1;f[c]&&f[c].call(h[c])})};this.enableButtons=function(){n.enable();r.enable()};this.disableButtons=function(){n.disable();r.disable()};this._onHome=function(){w.disableButtons();c=ON_BACK_MENU;w.hide()};this._onRestart=function(){w.disableButtons();s_oInterface.removeKeyListener();$(s_oMain).trigger("show_interlevel_ad");c=ON_RESTART;w.hide()};this.isVisible=function(){return a};this._init()}
function CPowerUp(a,e,c,f){var h,l,k,b;this._init=function(a,c,e){h=e;l=[];k=[];b=new createjs.Container;b.scaleX=b.scaleY=.1;b.x=a;b.y=c;f.addChild(b);c={images:[s_oSpriteLibrary.getSprite("power_up_"+h)],framerate:15,frames:{width:286,height:404},animations:{start:0,anim:[0,14]}};c=new createjs.SpriteSheet(c);c=createSprite(c,"anim",0,0,286,404);b.addChild(c);b.regX=143;b.regY=202;b.alpha=0;var d=(a-MIN_POWERUP_X)/(MAX_POWERUP_X-MIN_POWERUP_X)*1140;(new createjs.Tween.get(b)).to({alpha:1},500);
(new createjs.Tween.get(b)).to({scaleX:1,scaleY:1,x:d,y:POWERUP_FINAL_Y},1.5*TIME_OPPONENT_RUN,createjs.Ease.cubicIn).call(function(){if(l[ON_POWERUP_END_MOVE]){var a=new createjs.Rectangle(d-143,POWERUP_FINAL_Y-202,286,404);l[ON_POWERUP_END_MOVE].call(k[ON_POWERUP_END_MOVE],a,h);f.removeChild(b)}})};this.unload=function(){f.removeChild(b)};this.addEventListener=function(a,b,c){l[a]=b;k[a]=c};this.stopTween=function(){createjs.Tween.removeTweens(b)};this._init(a,e,c)}
function CNextLevelPanel(){var a,e,c,f,h,l,k,b,d,n,r,q,g,w,v,u=this;this._init=function(){a=!1;f=[];h=[];w=new createjs.Container;w.visible=!1;s_oStage.addChild(w);k=new createjs.Shape;k.graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);k.alpha=0;l=k.on("click",function(){});w.addChild(k);v=new createjs.Container;v.x=CANVAS_WIDTH/2;w.addChild(v);var c=s_oSpriteLibrary.getSprite("msg_box_wide"),p=createBitmap(c);v.addChild(p);d=new CTLText(v,0,0,c.width,120,80,"center","#ffffff",
FONT_GAME,1,40,10,"",!0,!0,!0,!1);b=new CTLText(v,0,c.height/2-70,c.width,60,80,"center","#ffffff",FONT_GAME,1,40,10,"",!0,!0,!0,!1);n=new CTLText(v,0,c.height/2,c.width,60,80,"center","#ffffff",FONT_GAME,1,40,10,"",!0,!0,!0,!1);r=new CGfxButton(c.width/2-250,c.height/2+120,s_oSpriteLibrary.getSprite("but_home"),v);r.addEventListener(ON_MOUSE_UP,this._onHome,this);q=new CGfxButton(c.width/2,c.height/2+120,s_oSpriteLibrary.getSprite("but_restart"),v);q.addEventListener(ON_MOUSE_UP,this._onRestart,
this);g=new CGfxButton(c.width/2+250,c.height/2+120,s_oSpriteLibrary.getSprite("but_next"),v);g.addEventListener(ON_MOUSE_UP,this._onNext,this);e=-c.height/2;v.regX=c.width/2;v.regY=c.height/2};this.unload=function(){r.unload();q.unload();k.off("click",l)};this.addEventListener=function(a,b,c){f[a]=b;h[a]=c};this.show=function(c,g,f){setVolume("soundtrack",0);playSound("level_win",1,!1).on("end",function(){setVolume("soundtrack",1)});d.refreshText(sprintf(TEXT_LEVEL_CLEARED,f));b.refreshText(TEXT_LEVEL_SCORE+
": "+c);n.refreshText(TEXT_SCORE+": "+g);k.alpha=0;v.y=e;w.visible=!0;createjs.Tween.get(k).to({alpha:.7},500);createjs.Tween.get(v).wait(400).to({y:CANVAS_HEIGHT/2},1E3,createjs.Ease.bounceOut).call(function(){u.enableButtons();a=!0})};this.hide=function(){createjs.Tween.get(v).to({y:e},1E3,createjs.Ease.backIn).call(function(){a=!1;w.visible=!1;f[c]&&f[c].call(h[c])})};this.enableButtons=function(){r.enable();g.enable();q.enable()};this.disableButtons=function(){r.disable();g.disable();q.disable()};
this._onHome=function(){u.disableButtons();c=ON_BACK_MENU;u.hide()};this._onRestart=function(){u.disableButtons();$(s_oMain).trigger("show_interlevel_ad");c=ON_RESTART;u.hide()};this._onNext=function(){s_oInterface.removeKeyListener();u.disableButtons();$(s_oMain).trigger("show_interlevel_ad");c=ON_NEXT_LEVEL;u.hide()};this.isVisible=function(){return a};this._init()}var MS_ROLLING_SCORE=400;
function CRollingScore(){var a=null,e=null;this.rolling=function(c,f,h){a=createjs.Tween.get(c).to({text:h},MS_ROLLING_SCORE,createjs.Ease.cubicOut).call(function(){createjs.Tween.removeTweens(a);c.color="#fff"}).addEventListener("change",function(){c.text=Math.floor(c.text)});null!==f&&(e=createjs.Tween.get(f).to({text:h},MS_ROLLING_SCORE,createjs.Ease.cubicOut).call(function(){createjs.Tween.removeTweens(e)}).addEventListener("change",function(){f.text=Math.floor(f.text)}))};return this}
function CScoreText(a,e,c,f){var h;this._init=function(a,c,b){h=new createjs.Text("+"+a," 80px "+FONT_GAME,"#fff");h.textAlign="center";h.x=c;h.y=b;h.alpha=0;h.shadow=new createjs.Shadow("#000",1,1,1);f.addChild(h);var d=this;createjs.Tween.get(h).to({alpha:1},200,createjs.Ease.quadIn).call(function(){d.moveUp()})};this.moveUp=function(){var a=h.y-400,c=this;createjs.Tween.get(h).to({y:a},1500,createjs.Ease.sineIn).call(function(){c.unload()});createjs.Tween.get(h).wait(800).to({alpha:0},500)};this.unload=
function(){f.removeChild(h)};this._init(a,e,c)}
function CPowerUpGui(a){var e,c,f,h,l,k,b;this._init=function(){var d=s_oSpriteLibrary.getSprite("powerup_gui_off");f=d.width;h=d.height;e=CANVAS_WIDTH-d.width-10;c=CANVAS_HEIGHT-d.height-10;b=new createjs.Container;b.x=e;b.y=c;b.visible=!1;a.addChild(b);var n=createBitmap(d);b.addChild(n);n=createBitmap(s_oSpriteLibrary.getSprite("powerup_gui_on"));b.addChild(n);k=new createjs.Shape;k.graphics.beginFill("rgba(0,0,0,0.01)").drawRect(0,0,d.width,d.height);b.addChild(k);n.mask=k;l=new createjs.Text("00:00",
"20px "+FONT_GAME,"#fff");l.x=d.width/2;l.y=-10;l.textBaseline="alphabetic";l.textAlign="center";b.addChild(l)};this.refreshButtonPos=function(){b.x=e-s_iOffsetX;b.y=c-s_iOffsetY};this.reset=function(){b.visible=!1};this.show=function(){this.refreshTime(0);b.x+=f+10;b.visible=!0;createjs.Tween.get(b).to({x:e-s_iOffsetX},1E3,createjs.Ease.backOut)};this.hide=function(){createjs.Tween.get(b).to({x:b.x+f+10},1E3,createjs.Ease.backIn).call(function(){b.visible=!1})};this.refreshTime=function(a){l.text=
formatTime(TIME_EFFECT_POWERUP-a);k.graphics.clear();a=Math.floor((100-Math.floor(a/TIME_EFFECT_POWERUP*100))*f/100);k.graphics.beginFill("rgba(0,0,0,0.01)").drawRect(0,0,a,h)};this._init()}
CTLText.prototype={constructor:CTLText,__autofit:function(){if(this._bFitText){for(var a=this._iFontSize;(this._oText.getBounds().height>this._iHeight-2*this._iPaddingV||this._oText.getBounds().width>this._iWidth-2*this._iPaddingH)&&!(a--,this._oText.font=a+"px "+this._szFont,this._oText.lineHeight=Math.round(a*this._fLineHeightFactor),this.__updateY(),this.__verticalAlign(),8>a););this._iFontSize=a}},__verticalAlign:function(){if(this._bVerticalAlign){var a=this._oText.getBounds().height;this._oText.y-=
(a-this._iHeight)/2+this._iPaddingV}},__updateY:function(){this._oText.y=this._y+this._iPaddingV;switch(this._oText.textBaseline){case "middle":this._oText.y+=this._oText.lineHeight/2+(this._iFontSize*this._fLineHeightFactor-this._iFontSize)}},__createText:function(a){this._bDebug&&(this._oDebugShape=new createjs.Shape,this._oDebugShape.graphics.beginFill("rgba(255,0,0,0.5)").drawRect(this._x,this._y,this._iWidth,this._iHeight),this._oContainer.addChild(this._oDebugShape));this._oText=new createjs.Text(a,
this._iFontSize+"px "+this._szFont,this._szColor);this._oText.textBaseline="middle";this._oText.lineHeight=Math.round(this._iFontSize*this._fLineHeightFactor);this._oText.textAlign=this._szAlign;this._oText.lineWidth=this._bMultiline?this._iWidth-2*this._iPaddingH:null;switch(this._szAlign){case "center":this._oText.x=this._x+this._iWidth/2;break;case "left":this._oText.x=this._x+this._iPaddingH;break;case "right":this._oText.x=this._x+this._iWidth-this._iPaddingH}this._oContainer.addChild(this._oText);
this.refreshText(a)},setVerticalAlign:function(a){this._bVerticalAlign=a},setOutline:function(a){null!==this._oText&&(this._oText.outline=a)},setShadow:function(a,e,c,f){null!==this._oText&&(this._oText.shadow=new createjs.Shadow(a,e,c,f))},setColor:function(a){this._oText.color=a},setAlpha:function(a){this._oText.alpha=a},removeTweens:function(){createjs.Tween.removeTweens(this._oText)},getText:function(){return this._oText},getY:function(){return this._y},getFontSize:function(){return this._iFontSize},
refreshText:function(a){""===a&&(a=" ");null===this._oText&&this.__createText(a);this._oText.text=a;this._oText.font=this._iFontSize+"px "+this._szFont;this._oText.lineHeight=Math.round(this._iFontSize*this._fLineHeightFactor);this.__autofit();this.__updateY();this.__verticalAlign()}};
function CTLText(a,e,c,f,h,l,k,b,d,n,r,q,g,w,v,u,t){this._oContainer=a;this._x=e;this._y=c;this._iWidth=f;this._iHeight=h;this._bMultiline=u;this._iFontSize=l;this._szAlign=k;this._szColor=b;this._szFont=d;this._iPaddingH=r;this._iPaddingV=q;this._bVerticalAlign=v;this._bFitText=w;this._bDebug=t;this._oDebugShape=null;this._fLineHeightFactor=n;this._oText=null;g&&this.__createText(g)}
function CChooseMenu(){var a,e,c,f,h,l,k,b,d,n,r,q,g,w,v=null,u=null;this._init=function(){var t=createBitmap(s_oSpriteLibrary.getSprite("bg_menu_level"));s_oStage.addChild(t);new CTLText(s_oStage,CANVAS_WIDTH/2-420,120,580,100,100,"center","#fff",FONT_GAME,1,0,0,TEXT_SELECT_TEAM,!0,!0,!0,!1);w=new createjs.Container;w.x=CANVAS_WIDTH/2-60;w.y=CANVAS_HEIGHT/2+122;s_oStage.addChild(w);k=[];var p=0,y=0;for(t=0;t<NUM_TEAMS;t++){var B=new CButFlag(p,y,t,TEAM_NAMES[t],w);B.addEventListenerWithParams(ON_MOUSE_UP,
this._onFlagSelected,this,t);p+=150;3===t%4&&(p=0,y+=150);k.push(B)}k[s_iTeamSelected].select();w.regX=w.getBounds().width/2;w.regY=w.getBounds().height/2;b=[];for(t=0;t<NUM_TEAMS;t++)p=s_oSpriteLibrary.getSprite("team_"+t),y=createBitmap(p),y.x=CANVAS_WIDTH/2+380,y.y=CANVAS_HEIGHT/2,y.regX=p.width/2,y.regY=p.height/2,s_oStage.addChild(y),t!==s_iTeamSelected&&(y.visible=!1),b.push(y);d=new CTextButton(CANVAS_WIDTH/2+380,CANVAS_HEIGHT/2+235,s_oSpriteLibrary.getSprite("but_go"),TEXT_PLAY,FONT_GAME,
"#fff",70,"right",40,s_oStage);d.addEventListener(ON_MOUSE_UP,this._onPlay,this);t=s_oSpriteLibrary.getSprite("but_exit");a=CANVAS_WIDTH-t.width/2-10;e=t.height/2+10;n=new CGfxButton(a,e,t,s_oStage);n.addEventListener(ON_MOUSE_UP,this._onExit,this);if(!1===DISABLE_SOUND_MOBILE||!1===s_bMobile)t=s_oSpriteLibrary.getSprite("audio_icon"),h=a-t.width/2-10,l=e,r=new CToggle(h,l,t,s_bAudioActive,s_oStage),r.addEventListener(ON_MOUSE_UP,this._onAudioToggle,this);t=window.document;p=t.documentElement;v=p.requestFullscreen||
p.mozRequestFullScreen||p.webkitRequestFullScreen||p.msRequestFullscreen;u=t.exitFullscreen||t.mozCancelFullScreen||t.webkitExitFullscreen||t.msExitFullscreen;!1===ENABLE_FULLSCREEN&&(v=!1);v&&screenfull.enabled&&(t=s_oSpriteLibrary.getSprite("but_fullscreen"),c=t.width/4+10,f=t.height/2+10,q=new CToggle(c,f,t,s_bFullscreen,s_oStage),q.addEventListener(ON_MOUSE_UP,this._onFullscreenRelease,this));g=new CLoaderResourcesPanel(s_oStage);g.addEventListener(ON_END_LOADING,this._onEndLoading,this);var A=
new createjs.Shape;A.graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);s_oStage.addChild(A);createjs.Tween.get(A).to({alpha:0},500).call(function(){A.visible=!1});this.refreshButtonPos()};this.unload=function(){createjs.Tween.removeAllTweens();for(var a=0;a<k.length;a++)k[a].unload();if(!1===DISABLE_SOUND_MOBILE||!1===s_bMobile)r.unload(),r=null;v&&screenfull.enabled&&q.unload();n.unload();g.unload();d.unload();s_oStage.removeAllChildren();s_oChooseMenu=null};this.refreshButtonPos=
function(){!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||r.setPosition(h-s_iOffsetX,s_iOffsetY+l);v&&screenfull.enabled&&q.setPosition(c+s_iOffsetX,f+s_iOffsetY);n.setPosition(a-s_iOffsetX,e+s_iOffsetY)};this._onFlagSelected=function(a){k[s_iTeamSelected].unselect();b[s_iTeamSelected].visible=!1;s_iTeamSelected=a;k[s_iTeamSelected].select();b[s_iTeamSelected].visible=!0};this._onAudioToggle=function(){Howler.mute(s_bAudioActive);s_bAudioActive=!s_bAudioActive};this._onEndLoading=function(){s_aTeamLoaded[s_iTeamSelected]=
!0;s_oChooseMenu.unload();s_oMain.gotoLevelMenu()};this._onExit=function(){s_oChooseMenu.unload();s_oMain.gotoMenu()};this.resetFullscreenBut=function(){v&&screenfull.enabled&&q.setActive(s_bFullscreen)};this._onFullscreenRelease=function(){s_bFullscreen?u.call(window.document):v.call(window.document.documentElement);sizeHandler()};this._onPlay=function(){s_oMain.createOpponentSeq();trace("s_aTeamLoaded["+s_iTeamSelected+"] "+s_aTeamLoaded[s_iTeamSelected]);if(s_aTeamLoaded[s_iTeamSelected])s_oChooseMenu.unload(),
s_oMain.gotoLevelMenu();else{for(var a=[],b=0;2>b;b++)a.push({name:"player"+s_iTeamSelected+"_run_"+b,path:"./sprites/player_"+s_iTeamSelected+"/player"+s_iTeamSelected+"_run_"+b+".png"});for(b=0;6>b;b++)a.push({name:"player"+s_iTeamSelected+"_touchdown_"+b,path:"./sprites/player_"+s_iTeamSelected+"/player"+s_iTeamSelected+"_touchdown_"+b+".png"});for(b=0;7>b;b++)a.push({name:"player"+s_iTeamSelected+"_jump_"+b,path:"./sprites/player_"+s_iTeamSelected+"/player"+s_iTeamSelected+"_jump_"+b+".png"});
a.push({name:"player"+s_iTeamSelected+"_falling",path:"./sprites/player_"+s_iTeamSelected+"/player"+s_iTeamSelected+"_falling.png"});g.start(a)}};s_oChooseMenu=this;this._init()}var s_oChooseMenu=null;
function CButFlag(a,e,c,f,h){var l,k,b,d,n,r,q,g,w,v,u;this._init=function(a,c,e,f){l=!1;k=1;b=[];d=[];g=new createjs.Container;g.x=a;g.y=c;g.cursor="pointer";h.addChild(g);a={images:[s_oSpriteLibrary.getSprite("flags")],frames:{width:124,height:124},animations:{team_0:0,team_1:1,team_2:2,team_3:3,team_4:4,team_5:5,team_6:6,team_7:7,team_8:8,team_9:9,team_10:10,team_11:11}};a=new createjs.SpriteSheet(a);u=createSprite(a,"team_"+e,0,0,124,124);g.addChild(u,w);w=new CTLText(g,6,100,112,22,30,"center",
"#fff",FONT_GAME,1,0,0,f,!0,!0,!1,!1);e=s_oSpriteLibrary.getSprite("team_selection");v=createBitmap(e);v.visible=!1;v.regX=e.width/2;v.regY=e.height/2;v.x=62;v.y=62;g.addChild(v);g.regX=g.getBounds().width/2;g.regY=g.getBounds().height/2;this._initListener()};this.unload=function(){g.off("mousedown",n);g.off("pressup",r);h.removeChild(g)};this.setVisible=function(a){g.visible=a};this.select=function(){v.visible=!0};this.unselect=function(){v.visible=!1};this.setAlign=function(a){w.textAlign=a};this.setScale=
function(a){k=a;g.scaleX=g.scaleY=a};this._initListener=function(){n=g.on("mousedown",this.buttonDown);r=g.on("pressup",this.buttonRelease)};this.addEventListener=function(a,c,e){b[a]=c;d[a]=e};this.addEventListenerWithParams=function(a,c,e,g){b[a]=c;d[a]=e;q=g};this.buttonRelease=function(){l||(playSound("click",1,!1),g.scaleX=k,g.scaleY=k,b[ON_MOUSE_UP]&&b[ON_MOUSE_UP].call(d[ON_MOUSE_UP],q))};this.buttonDown=function(){l||(g.scaleX=.9*k,g.scaleY=.9*k,b[ON_MOUSE_DOWN]&&b[ON_MOUSE_DOWN].call(d[ON_MOUSE_DOWN]))};
this.buttonOver=function(){l||u.gotoAndStop("over")};this.buttonOut=function(){l||u.gotoAndStop("idle")};this.setPosition=function(a,b){g.x=a;g.y=b};this.changeText=function(a){w.text=a};this.playSelectedAnim=function(a,c){l=!0;u.gotoAndStop("idle");(new createjs.Tween.get(g)).wait(500).to({x:a,y:c,scaleX:1,scaleY:1},1500,createjs.Ease.cubicOut).wait(500).call(function(){b[ON_END_SELECT_ANIM]&&b[ON_END_SELECT_ANIM].call(d[ON_END_SELECT_ANIM])})};this.playFadeOutAnim=function(){l=!0;(new createjs.Tween.get(g)).to({alpha:0},
800)};this.setX=function(a){g.x=a};this.setY=function(a){g.y=a};this.getButtonImage=function(){return g};this.getX=function(){return g.x};this.getY=function(){return g.y};this.getSprite=function(){return g};this._init(a,e,c,f)}
function CLoaderResourcesPanel(a){var e,c,f,h,l,k,b,d;this._init=function(){f=[];h=[];d=new createjs.Container;d.visible=!1;a.addChild(d);k=new createjs.Shape;k.graphics.beginFill("rgba(0,0,0,0.7)").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);l=k.on("mousedown",function(){});d.addChild(k);var c=new createjs.Text(TEXT_LOADING,"34px "+FONT_GAME,"#fff");c.textAlign="center";c.textBaseline="alphabetic";c.x=CANVAS_WIDTH/2;c.y=CANVAS_HEIGHT/2;d.addChild(c);c=s_oSpriteLibrary.getSprite("progress_loading");
b=createBitmap(c);b.regX=c.width/2;b.regY=c.height/2;b.x=CANVAS_WIDTH/2;b.y=CANVAS_HEIGHT/2+130;d.addChild(b)};this.unload=function(){createjs.Tween.removeTweens(b);k.off("mousedown",l)};this.addEventListener=function(a,b,c){f[a]=b;h[a]=c};this.start=function(a){s_oSpriteLibrary.init(this._onImageLoaded,this._onAllImagesLoaded,this);for(var k=c=e=0;k<a.length;k++)s_oSpriteLibrary.addSprite(a[k].name,a[k].path)&&c++;0<c?(s_oSpriteLibrary.loadSprites(),(new createjs.Tween.get(b,{loop:-1})).to({rotation:360},
500),d.visible=!0):f[ON_END_LOADING]&&f[ON_END_LOADING].call(h[ON_END_LOADING])};this._onImageLoaded=function(){e++;e===c&&f[ON_END_LOADING]&&f[ON_END_LOADING].call(h[ON_END_LOADING])};this._onAllImagesLoaded=function(){};this._init()}
function clearLocalStorage(){s_iLastLevel=1;s_iTeamSelected=0;s_aTeamSeq=[];for(var a=0;a<NUM_TEAMS;a++)s_aTeamLoaded[a]=!1;if(s_bStorageAvailable)for(a=0;a<localStorage.length;){var e=localStorage.key(a);-1!==e.indexOf(LOCALSTORAGE_STRING)?localStorage.removeItem(e):a++}}function setLocalStorageLevel(a){if(s_bStorageAvailable){var e=getItem(LOCALSTORAGE_STRING+"level");if(null===e||e<a)s_iLastLevel=a,saveItem(LOCALSTORAGE_STRING+"level",s_iLastLevel)}}
function setLocalStorageScore(a,e){s_bStorageAvailable&&saveItem(LOCALSTORAGE_STRING+"score_level_"+e,a)}function setOpponentSeq(){s_bStorageAvailable&&saveItem(LOCALSTORAGE_STRING+"opponent_seq",JSON.stringify(s_aTeamSeq))}function setTeam(){saveItem(LOCALSTORAGE_STRING+"team",s_iTeamSelected)}function getLevelScore(a){return s_bStorageAvailable?(a=getItem(LOCALSTORAGE_STRING+"score_level_"+a))?a:0:0}
function getScoreTillLevel(a){if(!s_bStorageAvailable)return 0;for(var e=0,c=0;c<a-1;c++)e+=parseInt(getItem(LOCALSTORAGE_STRING+"score_level_"+(c+1)));return e}function getSavedLevel(){if(!s_bStorageAvailable)return 1;var a=getItem(LOCALSTORAGE_STRING+"level");return null===a?1:a}function getOpponentSeq(){return s_bStorageAvailable?JSON.parse(getItem(LOCALSTORAGE_STRING+"opponent_seq")):[]}function getStoredTeamSelected(){return s_bStorageAvailable?getItem(LOCALSTORAGE_STRING+"team"):0}
function CCountdownController(a,e,c){var f,h,l,k,b,d=this;this._init=function(a,d){l=[];k=[];b=new createjs.Container;b.visible=!1;b.x=a;b.y=d;c.addChild(b);h=[];for(var e=0;4>e;e++){var g=s_oSpriteLibrary.getSprite("countdown_"+(4-e-1)),f=createBitmap(g);f.regX=g.width/2;f.regY=g.height/2;b.addChild(f);h.push(f)}};this.addEventListener=function(a,b,c){l[a]=b;k[a]=c};this.reset=function(){for(var a=0;a<h.length;a++)h[a].scaleX=h[a].scaleY=.1,h[a].alpha=0};this.start=function(){f=0;b.visible=!0;this._playAnim()};
this._playAnim=function(){0<f&&createjs.Tween.get(h[f-1]).to({alpha:0},300,createjs.Ease.cubicOut);f===h.length?l[ON_END_COUNTDOWN]&&l[ON_END_COUNTDOWN].call(k[ON_END_COUNTDOWN]):(createjs.Tween.get(h[f]).to({alpha:1},300,createjs.Ease.cubicOut).call(function(){f===h.length-1?playSound("go",1,!1):playSound("countdown_"+(3-f),1,!1)}),createjs.Tween.get(h[f]).to({scaleX:1,scaleY:1},1E3,createjs.Ease.quartOut).call(function(){f++;d._playAnim()}))};this._init(a,e)}
function extractHostname(a){a=-1<a.indexOf("://")?a.split("/")[2]:a.split("/")[0];a=a.split(":")[0];return a=a.split("?")[0]}function extractRootDomain(a){a=extractHostname(a);var e=a.split("."),c=e.length;2<c&&(a=e[c-2]+"."+e[c-1]);return a}
var getClosestTop=function(){var a=window,e=!1;try{for(;a.parent.document!==a.document;)if(a.parent.document)a=a.parent;else{e=!0;break}}catch(c){e=!0}return{topFrame:a,err:e}},getBestPageUrl=function(a){var e=a.topFrame,c="";if(a.err)try{try{c=window.top.location.href}catch(h){var f=window.location.ancestorOrigins;c=f[f.length-1]}}catch(h){c=e.document.referrer}else c=e.location.href;return c},TOPFRAMEOBJ=getClosestTop(),PAGE_URL=getBestPageUrl(TOPFRAMEOBJ);
function seekAndDestroy(){for(var a=extractRootDomain(PAGE_URL),e=[String.fromCharCode(99,111,100,101,116,104,105,115,108,97,98,46,99,111,109),String.fromCharCode(101,110,118,97,116,111,46,99,111,109),String.fromCharCode(99,111,100,101,99,97,110,121,111,110,46,99,111,109),String.fromCharCode(99,111,100,101,99,97,110,121,111,110,46,110,101,116)],c=0;c<e.length;c++)if(e[c]===a)return!0;return!0};